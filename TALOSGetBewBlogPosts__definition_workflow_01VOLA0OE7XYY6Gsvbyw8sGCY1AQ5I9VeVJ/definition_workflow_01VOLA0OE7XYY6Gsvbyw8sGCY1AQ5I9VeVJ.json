{
  "workflow": {
    "unique_name": "definition_workflow_01VOLA0OE7XYY6Gsvbyw8sGCY1AQ5I9VeVJ",
    "name": "Talos - Get New Blog Posts",
    "title": "Talos - Get New Blog Posts",
    "type": "generic.workflow",
    "base_type": "workflow",
    "variables": [
      {
        "schema_id": "datatype.string",
        "properties": {
          "value": "",
          "scope": "local",
          "name": "RSS Etag",
          "type": "datatype.string",
          "description": "Placeholder for the latest Etag from the blog. This will be populated automatically",
          "is_required": false,
          "is_invisible": false
        },
        "unique_name": "variable_workflow_01VOLA0OQSNFV0ctIKH0xbYWiF5ZwWzynZ1",
        "object_type": "variable_workflow"
      },
      {
        "schema_id": "datatype.string",
        "properties": {
          "value": "SecureX PTH Talos Notifications",
          "scope": "local",
          "name": "Webex Teams Room Name",
          "type": "datatype.string",
          "description": "The name of the Webex Teams room to post messages to. If using a bot, make sure to invite your bot to the room before attempting to send messages. If you don't want to use Webex, leave this blank",
          "is_required": false,
          "is_invisible": false
        },
        "unique_name": "variable_workflow_01VOLA0OQSAQ80kKbQYO2X5Otp5bdjqp5gK",
        "object_type": "variable_workflow"
      },
      {
        "schema_id": "datatype.date",
        "properties": {
          "value": "0001-01-01T00:00:00+00:00",
          "scope": "local",
          "name": "RSS Last-Modified",
          "type": "datatype.date",
          "description": "Placeholder for the latest Last-Modified date header from the blog. This will be populated automatically",
          "is_required": false,
          "is_invisible": false
        },
        "unique_name": "variable_workflow_01VOLA0OQRXKP5HwBuQzbFPhUzOmgu7ckMB",
        "object_type": "variable_workflow"
      },
      {
        "schema_id": "datatype.secure_string",
        "properties": {
          "value": "*****",
          "scope": "local",
          "name": "Webex Teams Access Token",
          "type": "datatype.secure_string",
          "description": "The access token to use to authenticate to the Webex Teams API. Information about using a bot, which is what we recommend, can be found here: https://developer.webex.com/docs/bots",
          "is_required": false,
          "is_invisible": false
        },
        "unique_name": "variable_workflow_01VOLA0OQSVWK02VGJrvRunO36GbRZIJY69",
        "object_type": "variable_workflow"
      }
    ],
    "properties": {
      "atomic": {
        "is_atomic": false
      },
      "delete_workflow_instance": false,
      "description": "This workflow consumes the Talos Intelligence Blog RSS feed and converts individual blog posts into Cisco SecureX casebooks if they contain suspicious observables. These casebooks can then be investigated with one click in Cisco Threat Response.\n\nTarget: HTTP Endpoint named \"Talos Intelligence Blog\" for \"feeds.feedburner.com\" with a path of \"/feedburner/Talos\"\n\nAccount Key: None\n\nSteps:\n[] Get the RSS feed XML\n[] If the Etag is the same or there aren’t any recent updates, end the workflow\n[] Get the updated Etag and Last-Modified headers\n[] Convert the feed XML into JSON and parse out each post’s information\n[] For each blog post:\n[]\u003e Check if the post has been updated since the last run of the workflow, if not, skip it\n[]\u003e Run a sub-workflow to parse this single blog post\n[] Update the global variables with the new Etag and Last-Modified date\n\nMore information: https://ciscosecurity.github.io/sxo-05-security-workflows/workflows/0001",
      "display_name": "Talos - Get New Blog Posts",
      "runtime_user": {
        "override_target_runtime_user": false,
        "specify_on_workflow_start": false,
        "target_default": true
      },
      "target": {
        "target_type": "web-service.endpoint",
        "target_id": "definition_target_01FX7HMOEIXDR0ayWxCRU8PWaTeOpnu5aNq",
        "execute_on_workflow_target": true
      }
    },
    "object_type": "definition_workflow",
    "actions": [
      {
        "unique_name": "definition_activity_01VOLA4E76UKU7VS4w34G5WMGVgqxf11cv7",
        "name": "Group",
        "title": "Fetch global variables",
        "type": "logic.group",
        "base_type": "activity",
        "properties": {
          "continue_on_failure": false,
          "display_name": "Fetch global variables",
          "skip_execution": false
        },
        "object_type": "definition_activity",
        "actions": [
          {
            "unique_name": "definition_activity_01VOLA4GPPKVM0XqR8BFoczCb7s5ha4Vwmx",
            "name": "Set Variables",
            "title": "Fetch global variables",
            "type": "core.set_multiple_variables",
            "base_type": "activity",
            "properties": {
              "continue_on_failure": false,
              "display_name": "Fetch global variables",
              "skip_execution": true,
              "variables_to_update": [
                {
                  "variable_to_update": "$workflow.definition_workflow_01VOLA0OE7XYY6Gsvbyw8sGCY1AQ5I9VeVJ.local.variable_workflow_01VOLA0OQSVWK02VGJrvRunO36GbRZIJY69$",
                  "variable_value_new": ""
                }
              ]
            },
            "object_type": "definition_activity"
          }
        ]
      },
      {
        "unique_name": "definition_activity_01VOLA4IWEZCG6j5pBh0ng4PLGThBRuiyhv",
        "name": "Condition Block",
        "title": "Is the last modified global variable populated?",
        "type": "logic.if_else",
        "base_type": "activity",
        "properties": {
          "continue_on_failure": false,
          "display_name": "Is the last modified global variable populated?",
          "skip_execution": false
        },
        "object_type": "definition_activity",
        "blocks": [
          {
            "unique_name": "definition_activity_01VOLA4KOS71O4olRbUrGJPzU8ygTDZOwqO",
            "name": "Condition Branch",
            "title": "No",
            "type": "logic.condition_block",
            "base_type": "activity",
            "properties": {
              "condition": {
                "left_operand": "$global.variable_01JNI7VSR47ZV0QY21qMyGvZLxB8DLApExq.global.variable_01JNI7VSR47ZV0QY21qMyGvZLxB8DLApExq$",
                "operator": "eq",
                "right_operand": "0001-01-01T00:00:00+00:00"
              },
              "continue_on_failure": false,
              "display_name": "No",
              "skip_execution": false
            },
            "object_type": "definition_activity",
            "actions": [
              {
                "unique_name": "definition_activity_01VOLA4N9G6SF25F4rtSMYfRSnKGEOjlM5V",
                "name": "Calculate Date",
                "title": "Calculate 7 days ago",
                "type": "core.calculate_date",
                "base_type": "activity",
                "properties": {
                  "adjustment": -604800,
                  "continue_on_failure": false,
                  "display_name": "Calculate 7 days ago",
                  "original_date": "$workflow.definition_workflow_01VOLA0OE7XYY6Gsvbyw8sGCY1AQ5I9VeVJ.output.start_time$",
                  "skip_execution": false
                },
                "object_type": "definition_activity"
              },
              {
                "unique_name": "definition_activity_01VOLA4P9PDR62wS6ZDyiu8ggmT8wMurQdE",
                "name": "Set Variables",
                "title": "Set global variable",
                "type": "core.set_multiple_variables",
                "base_type": "activity",
                "properties": {
                  "continue_on_failure": false,
                  "display_name": "Set global variable",
                  "skip_execution": false,
                  "variables_to_update": [
                    {
                      "variable_to_update": "$global.variable_01JNI7VSR47ZV0QY21qMyGvZLxB8DLApExq.global.variable_01JNI7VSR47ZV0QY21qMyGvZLxB8DLApExq$",
                      "variable_value_new": "$activity.definition_activity_01VOLA4N9G6SF25F4rtSMYfRSnKGEOjlM5V.output.result$"
                    }
                  ]
                },
                "object_type": "definition_activity"
              }
            ]
          }
        ]
      },
      {
        "unique_name": "definition_activity_01VOLA4QTNRZ54iPtEj2PsGU4vLGjkbxaHJ",
        "name": "HTTP Request",
        "title": "Get RSS feed XML",
        "type": "web-service.http_request",
        "base_type": "activity",
        "properties": {
          "action_timeout": 180,
          "allow_auto_redirect": true,
          "content_type": "application/xml",
          "continue_on_error_status_code": true,
          "continue_on_failure": false,
          "custom_headers": [
            {
              "name": "If-None-Match",
              "value": "$global.variable_01JNHUXUS6AOJ01kru5YMihoCRZszke5o2c.global.variable_01JNHUXUS6AOJ01kru5YMihoCRZszke5o2c$"
            }
          ],
          "display_name": "Get RSS feed XML",
          "method": "GET",
          "runtime_user": {
            "override_target_runtime_user": false,
            "target_default": true
          },
          "skip_execution": false,
          "target": {
            "override_workflow_target": false,
            "override_workflow_target_group_criteria": false,
            "use_workflow_target": true,
            "use_workflow_target_group": false
          }
        },
        "object_type": "definition_activity"
      },
      {
        "unique_name": "definition_activity_01VOLA4RTJR1170FI7RsfTTXHTg4a8fKlMP",
        "name": "Condition Block",
        "title": "What was the HTTP result?",
        "type": "logic.if_else",
        "base_type": "activity",
        "properties": {
          "continue_on_failure": false,
          "display_name": "What was the HTTP result?",
          "skip_execution": false
        },
        "object_type": "definition_activity",
        "blocks": [
          {
            "unique_name": "definition_activity_01VOLA4SR10SM2a2JGNNQHsEQWjjQx4yB6K",
            "name": "Condition Branch",
            "title": "304/Etag is the same",
            "type": "logic.condition_block",
            "base_type": "activity",
            "properties": {
              "condition": {
                "left_operand": "$activity.definition_activity_01VOLA4QTNRZ54iPtEj2PsGU4vLGjkbxaHJ.output.status_code$",
                "operator": "eq",
                "right_operand": 304
              },
              "continue_on_failure": false,
              "display_name": "304/Etag is the same",
              "skip_execution": false
            },
            "object_type": "definition_activity",
            "actions": [
              {
                "unique_name": "definition_activity_01VOLA4TSBF6V3GLpce9ORuq5dZ0mNhy3NJ",
                "name": "Completed",
                "title": "Completed",
                "type": "logic.completed",
                "base_type": "activity",
                "properties": {
                  "completion_type": "succeeded",
                  "continue_on_failure": false,
                  "display_name": "Completed",
                  "result_message": "No new blog posts need to be parsed",
                  "skip_execution": false
                },
                "object_type": "definition_activity"
              }
            ]
          },
          {
            "unique_name": "definition_activity_01VOLA4UP7X6D3RdQL00ifaZIQHLyobKAJy",
            "name": "Condition Branch",
            "title": "Anything else not 200",
            "type": "logic.condition_block",
            "base_type": "activity",
            "properties": {
              "condition": {
                "left_operand": "$activity.definition_activity_01VOLA4QTNRZ54iPtEj2PsGU4vLGjkbxaHJ.output.status_code$",
                "operator": "ne",
                "right_operand": 200
              },
              "continue_on_failure": false,
              "display_name": "Anything else not 200",
              "skip_execution": false
            },
            "object_type": "definition_activity",
            "actions": [
              {
                "unique_name": "definition_activity_01VOLA4VWRZOH58WtXKdSfwHbNymLKgM6MA",
                "name": "Completed",
                "title": "Failed",
                "type": "logic.completed",
                "base_type": "activity",
                "properties": {
                  "completion_type": "failed-completed",
                  "continue_on_failure": false,
                  "display_name": "Failed",
                  "result_message": "Failed to retrieve RSS feed content\n\nStatus code: $activity.definition_activity_01VOLA4QTNRZ54iPtEj2PsGU4vLGjkbxaHJ.output.status_code$\nResponse body: $activity.definition_activity_01VOLA4QTNRZ54iPtEj2PsGU4vLGjkbxaHJ.output.response_body$",
                  "skip_execution": false
                },
                "object_type": "definition_activity"
              }
            ]
          }
        ]
      },
      {
        "unique_name": "definition_activity_01VOLA4WQYKWI5ad7DekG70G2ruotIRx4In",
        "name": "For Each",
        "title": "Parse blog headers",
        "type": "logic.for_each",
        "base_type": "activity",
        "properties": {
          "continue_on_failure": false,
          "display_name": "Parse blog headers",
          "skip_execution": false,
          "source_array": "$activity.definition_activity_01VOLA4QTNRZ54iPtEj2PsGU4vLGjkbxaHJ.output.response_headers$"
        },
        "object_type": "definition_activity",
        "actions": [
          {
            "unique_name": "definition_activity_01VOLA4YGU6TH3yoSN9y0Ne5vO5CXfDSsii",
            "name": "Condition Block",
            "title": "Is this a header we want?",
            "type": "logic.if_else",
            "base_type": "activity",
            "properties": {
              "continue_on_failure": false,
              "display_name": "Is this a header we want?",
              "skip_execution": false
            },
            "object_type": "definition_activity",
            "blocks": [
              {
                "unique_name": "definition_activity_01VOLA4ZEO6PU1H6NCyUPRP98GLEQDF2CIh",
                "name": "Condition Branch",
                "title": "Etag",
                "type": "logic.condition_block",
                "base_type": "activity",
                "properties": {
                  "condition": {
                    "left_operand": "$activity.definition_activity_01VOLA4WQYKWI5ad7DekG70G2ruotIRx4In.input.source_array[@].name$",
                    "operator": "eqi",
                    "right_operand": "Etag"
                  },
                  "continue_on_failure": false,
                  "display_name": "Etag",
                  "skip_execution": false
                },
                "object_type": "definition_activity",
                "actions": [
                  {
                    "unique_name": "definition_activity_01VOLA50JLXKG5s3DZ1IuxdXOBpkGrLuxrh",
                    "name": "Set Variables",
                    "title": "Set local variables",
                    "type": "core.set_multiple_variables",
                    "base_type": "activity",
                    "properties": {
                      "continue_on_failure": false,
                      "display_name": "Set local variables",
                      "skip_execution": false,
                      "variables_to_update": [
                        {
                          "variable_to_update": "$workflow.definition_workflow_01VOLA0OE7XYY6Gsvbyw8sGCY1AQ5I9VeVJ.local.variable_workflow_01VOLA0OQSNFV0ctIKH0xbYWiF5ZwWzynZ1$",
                          "variable_value_new": "$activity.definition_activity_01VOLA4WQYKWI5ad7DekG70G2ruotIRx4In.input.source_array[@].value$"
                        }
                      ]
                    },
                    "object_type": "definition_activity"
                  }
                ]
              },
              {
                "unique_name": "definition_activity_01VOLA51PMVMC1NeXlfWleMSd2S76ijrcpR",
                "name": "Condition Branch",
                "title": "Last-Modified",
                "type": "logic.condition_block",
                "base_type": "activity",
                "properties": {
                  "condition": {
                    "left_operand": "$activity.definition_activity_01VOLA4WQYKWI5ad7DekG70G2ruotIRx4In.input.source_array[@].name$",
                    "operator": "eqi",
                    "right_operand": "Last-Modified"
                  },
                  "continue_on_failure": false,
                  "display_name": "Last-Modified",
                  "skip_execution": false
                },
                "object_type": "definition_activity",
                "actions": [
                  {
                    "unique_name": "definition_activity_01VOLA530WCPE4fCWp25xSifXeoU2YyHFev",
                    "name": "Set Variables",
                    "title": "Set local variables",
                    "type": "core.set_multiple_variables",
                    "base_type": "activity",
                    "properties": {
                      "continue_on_failure": false,
                      "display_name": "Set local variables",
                      "skip_execution": false,
                      "variables_to_update": [
                        {
                          "variable_to_update": "$workflow.definition_workflow_01VOLA0OE7XYY6Gsvbyw8sGCY1AQ5I9VeVJ.local.variable_workflow_01VOLA0OQRXKP5HwBuQzbFPhUzOmgu7ckMB$",
                          "variable_value_new": "$activity.definition_activity_01VOLA4WQYKWI5ad7DekG70G2ruotIRx4In.input.source_array[@].value$"
                        }
                      ]
                    },
                    "object_type": "definition_activity"
                  }
                ]
              }
            ]
          }
        ]
      },
      {
        "unique_name": "definition_activity_01VOLA547RCUL1raIpcpW0k2iWKSCURjTig",
        "name": "Convert Xml to Json",
        "title": "Convert RSS XML to JSON",
        "type": "core.xml2json",
        "base_type": "activity",
        "properties": {
          "continue_on_failure": false,
          "display_name": "Convert RSS XML to JSON",
          "input_xml": "$activity.definition_activity_01VOLA4QTNRZ54iPtEj2PsGU4vLGjkbxaHJ.output.response_body$",
          "skip_execution": false
        },
        "object_type": "definition_activity"
      },
      {
        "unique_name": "definition_activity_01VOLA55CI1OC0OeTehGkRMywPaPDB56XbD",
        "name": "Read Table from JSON",
        "title": "Convert list of posts to table",
        "type": "corejava.read_table_from_json",
        "base_type": "activity",
        "properties": {
          "action_timeout": 180,
          "continue_on_failure": false,
          "display_name": "Convert list of posts to table",
          "input_json": "$activity.definition_activity_01VOLA547RCUL1raIpcpW0k2iWKSCURjTig.output.output_json$",
          "jsonpath_query": "$.rss.channel.item[*]",
          "persist_output": false,
          "populate_columns": false,
          "skip_execution": false,
          "table_columns": [
            {
              "column_name": "link",
              "column_type": "string"
            },
            {
              "column_name": "title",
              "column_type": "string"
            },
            {
              "column_name": "pubDate",
              "column_type": "date",
              "zdate_type_format": "E, dd MMM yyyy HH:mm:ss z"
            }
          ]
        },
        "object_type": "definition_activity"
      },
      {
        "unique_name": "definition_activity_01VOLA56I34M76YmmaPYNeWuRnUWr5CcLD5",
        "name": "For Each",
        "title": "For each post",
        "type": "logic.for_each",
        "base_type": "activity",
        "properties": {
          "continue_on_failure": false,
          "display_name": "For each post",
          "skip_execution": false,
          "source_array": "$activity.definition_activity_01VOLA55CI1OC0OeTehGkRMywPaPDB56XbD.output.read_table_from_json$"
        },
        "object_type": "definition_activity",
        "actions": [
          {
            "unique_name": "definition_activity_01VOLA5801ER76mePrTvRQE7Dd7aA8Oa8XW",
            "name": "Condition Block",
            "title": "Is this a post we should skip?",
            "type": "logic.if_else",
            "base_type": "activity",
            "properties": {
              "continue_on_failure": false,
              "display_name": "Is this a post we should skip?",
              "skip_execution": false
            },
            "object_type": "definition_activity",
            "blocks": [
              {
                "unique_name": "definition_activity_01VOLA590LXUY4311YnqeZGaiS8sl9LkFyF",
                "name": "Condition Branch",
                "title": "Not updated since last run",
                "type": "logic.condition_block",
                "base_type": "activity",
                "properties": {
                  "condition": {
                    "left_operand": "$activity.definition_activity_01VOLA56I34M76YmmaPYNeWuRnUWr5CcLD5.input.source_array[@].pubDate$",
                    "operator": "lt",
                    "right_operand": "$global.variable_01JNI7VSR47ZV0QY21qMyGvZLxB8DLApExq.global.variable_01JNI7VSR47ZV0QY21qMyGvZLxB8DLApExq$"
                  },
                  "continue_on_failure": false,
                  "display_name": "Not updated since last run",
                  "skip_execution": false
                },
                "object_type": "definition_activity",
                "actions": [
                  {
                    "unique_name": "definition_activity_01VOLA5A2DKJW48OaabtyL1mJvSNfUSsgvk",
                    "name": "Continue",
                    "title": "Skip this post",
                    "type": "logic.continue",
                    "base_type": "activity",
                    "properties": {
                      "continue_on_failure": false,
                      "display_name": "Skip this post",
                      "skip_execution": false
                    },
                    "object_type": "definition_activity"
                  }
                ]
              },
              {
                "unique_name": "definition_activity_01VOLA5B38GDG1mHCvwbFp1iMmDG0KptRQ0",
                "name": "Condition Branch",
                "title": "Roundup or spotlight post",
                "type": "logic.condition_block",
                "base_type": "activity",
                "properties": {
                  "condition": {
                    "left_operand": {
                      "left_operand": "$activity.definition_activity_01VOLA56I34M76YmmaPYNeWuRnUWr5CcLD5.input.source_array[@].link$",
                      "operator": "mregex",
                      "right_operand": ".*roundup.*"
                    },
                    "operator": "or",
                    "right_operand": {
                      "left_operand": "$activity.definition_activity_01VOLA56I34M76YmmaPYNeWuRnUWr5CcLD5.input.source_array[@].link$",
                      "operator": "mregex",
                      "right_operand": ".*spotlight.*"
                    }
                  },
                  "continue_on_failure": false,
                  "display_name": "Roundup or spotlight post",
                  "skip_execution": false
                },
                "object_type": "definition_activity",
                "actions": [
                  {
                    "unique_name": "definition_activity_01VOLA5C82JEA3pJUBjJGmkTR2d4orcbV84",
                    "name": "Continue",
                    "title": "Skip this post",
                    "type": "logic.continue",
                    "base_type": "activity",
                    "properties": {
                      "continue_on_failure": false,
                      "display_name": "Skip this post",
                      "skip_execution": false
                    },
                    "object_type": "definition_activity"
                  }
                ]
              }
            ]
          },
          {
            "unique_name": "definition_activity_01VOLA5DOM4ZQ5LTE7IZAnu1Hvt3DHVWdVw",
            "name": "0001 - Talos - Blog Post to SecureX Casebook",
            "title": "0001 - Talos - Blog Post to SecureX Casebook",
            "type": "workflow.sub_workflow",
            "base_type": "subworkflow",
            "properties": {
              "continue_on_failure": false,
              "display_name": "0001 - Talos - Blog Post to SecureX Casebook",
              "input": {
                "variable_workflow_01VOLA0VX7SMR4YXBdZgLUGSpHwwCZop6bE": "$activity.definition_activity_01VOLA56I34M76YmmaPYNeWuRnUWr5CcLD5.input.source_array[@].link$"
              },
              "runtime_user": {
                "target_default": true
              },
              "skip_execution": false,
              "target": {
                "execute_on_this_target_group": true,
                "target_group_id": "target_group_01EJ0TQWPQWBD0qiWqClJKj9FOzwiZRfOFH"
              },
              "workflow_id": "definition_workflow_01VOLA0VQ6P2T2IZPvsWqEKAmYFbu5J1X9T",
              "workflow_name": "Talos - Blog Post to SecureX Casebook"
            },
            "object_type": "definition_activity"
          }
        ]
      },
      {
        "unique_name": "definition_activity_01VOLA5FFRAK91lbC7E9ZNkKPKTYtA9g7dG",
        "name": "Set Variables",
        "title": "Update global variables",
        "type": "core.set_multiple_variables",
        "base_type": "activity",
        "properties": {
          "continue_on_failure": false,
          "display_name": "Update global variables",
          "skip_execution": false,
          "variables_to_update": [
            {
              "variable_to_update": "$global.variable_01JNHUXUS6AOJ01kru5YMihoCRZszke5o2c.global.variable_01JNHUXUS6AOJ01kru5YMihoCRZszke5o2c$",
              "variable_value_new": "$workflow.definition_workflow_01VOLA0OE7XYY6Gsvbyw8sGCY1AQ5I9VeVJ.local.variable_workflow_01VOLA0OQSNFV0ctIKH0xbYWiF5ZwWzynZ1$"
            },
            {
              "variable_to_update": "$global.variable_01JNI7VSR47ZV0QY21qMyGvZLxB8DLApExq.global.variable_01JNI7VSR47ZV0QY21qMyGvZLxB8DLApExq$",
              "variable_value_new": "$workflow.definition_workflow_01VOLA0OE7XYY6Gsvbyw8sGCY1AQ5I9VeVJ.local.variable_workflow_01VOLA0OQRXKP5HwBuQzbFPhUzOmgu7ckMB$"
            }
          ]
        },
        "object_type": "definition_activity"
      }
    ],
    "categories": [
      "category_01WP7A6HKXUQ45kzpk5nMHdP8VADtokMxCW"
    ]
  },
  "categories": {
    "category_01WP7A6HKXUQ45kzpk5nMHdP8VADtokMxCW": {
      "unique_name": "category_01WP7A6HKXUQ45kzpk5nMHdP8VADtokMxCW",
      "name": "Production",
      "title": "Production",
      "type": "basic.category",
      "base_type": "category",
      "description": "Workflows working in production",
      "category_type": "custom",
      "object_type": "category"
    }
  },
  "triggers": {
    "triggerschedule_01VOLCP5JMJ403OtGpv8U3cfIXc0NovPPGL": {
      "workflow_id": "definition_workflow_01VOLA0OE7XYY6Gsvbyw8sGCY1AQ5I9VeVJ",
      "name": "Daily Schedule",
      "title": "",
      "lowercase_name": "schedule.daily_schedule",
      "type": "schedule",
      "base_type": "trigger",
      "ref_id": "schedule_01VOLCO5376M0707hPyrKBIenZzLq2gyXJN",
      "version": "1.0.0",
      "disabled": false,
      "unique_name": "triggerschedule_01VOLCP5JMJ403OtGpv8U3cfIXc0NovPPGL",
      "object_type": "triggerschedule"
    }
  },
  "schedules": {
    "schedule_01VOLCO5376M0707hPyrKBIenZzLq2gyXJN": {
      "unique_name": "schedule_01VOLCO5376M0707hPyrKBIenZzLq2gyXJN",
      "name": "Talos Daily Observations ",
      "type": "basic.schedule",
      "base_type": "schedule",
      "properties": {
        "calendar": "calendar_recurring_1BMfMWvgiDhSjBQ7hTSyvz3NyVZ",
        "timezone": "US/Eastern",
        "starttime": "01:00",
        "interval_hours": 0,
        "interval_minutes": 0,
        "number_of_times": 1,
        "display_name": "Talos Daily Observations ",
        "description": ""
      },
      "version": "1.0.0",
      "object_type": "schedule"
    }
  },
  "targets": {
    "definition_target_01FX7HMOEIXDR0ayWxCRU8PWaTeOpnu5aNq": {
      "unique_name": "definition_target_01FX7HMOEIXDR0ayWxCRU8PWaTeOpnu5aNq",
      "name": "Talos Intelligence Blog",
      "title": "Talos Intelligence Blog",
      "type": "web-service.endpoint",
      "base_type": "target",
      "object_type": "definition_target",
      "properties": {
        "disable_certificate_validation": false,
        "display_name": "Talos Intelligence Blog",
        "host": "feeds.feedburner.com",
        "ignore_proxy": false,
        "no_runtime_user": true,
        "path": "/feedburner/Talos",
        "port": 443,
        "protocol": "https"
      }
    }
  },
  "target_groups": {
    "target_group_01EJ0TQWPQWBD0qiWqClJKj9FOzwiZRfOFH": {
      "unique_name": "target_group_01EJ0TQWPQWBD0qiWqClJKj9FOzwiZRfOFH",
      "name": "Default TargetGroup",
      "title": "Default TargetGroup",
      "type": "generic.target_group",
      "base_type": "target_group",
      "version": "1.0.0",
      "targets": [
        {
          "data_target_type": "web-service.endpoint",
          "view_target_type": "web-service.endpoint",
          "include_all_targets": true
        },
        {
          "data_target_type": "email.smtp_endpoint",
          "view_target_type": "email.smtp_endpoint",
          "include_all_targets": true
        }
      ],
      "object_type": "target_group"
    }
  },
  "variables": {
    "variable_01JNHUXUS6AOJ01kru5YMihoCRZszke5o2c": {
      "unique_name": "variable_01JNHUXUS6AOJ01kru5YMihoCRZszke5o2c",
      "properties": {
        "value": "viQP/yX2KsPvzNol//YfMaTxtss",
        "scope": "global",
        "name": "0001 - Talos Blog - Etag",
        "type": "datatype.string",
        "is_required": false,
        "is_invisible": false
      },
      "object_type": "variable"
    },
    "variable_01JNI7VSR47ZV0QY21qMyGvZLxB8DLApExq": {
      "unique_name": "variable_01JNI7VSR47ZV0QY21qMyGvZLxB8DLApExq",
      "properties": {
        "value": "Wed, 18 May 2022 04:46:15 GMT",
        "scope": "global",
        "name": "0001 - Talos Blog - Last Modified",
        "type": "datatype.date",
        "is_required": false,
        "is_invisible": false
      },
      "object_type": "variable"
    },
    "variable_01VV6QKZGWUH70LtaJK0PunYbGZmbGYzM2B": {
      "unique_name": "variable_01VV6QKZGWUH70LtaJK0PunYbGZmbGYzM2B",
      "properties": {
        "value": "*****",
        "scope": "env",
        "name": "SecureX-PTH Talos Notifications",
        "type": "datatype.secure_string",
        "is_required": false,
        "is_invisible": false
      },
      "object_type": "variable"
    }
  },
  "subworkflows": [
    {
      "workflow": {
        "unique_name": "definition_workflow_01VOLA0VQ6P2T2IZPvsWqEKAmYFbu5J1X9T",
        "name": "Talos - Blog Post to SecureX Casebook",
        "title": "Talos - Blog Post to SecureX Casebook",
        "type": "generic.workflow",
        "base_type": "workflow",
        "variables": [
          {
            "schema_id": "datatype.string",
            "properties": {
              "value": "[]",
              "scope": "local",
              "name": "Targets",
              "type": "datatype.string",
              "description": "Placeholder for a list of targets from your Threat Response module sightings. This will be populated automatically",
              "is_required": false,
              "is_invisible": false
            },
            "unique_name": "variable_workflow_01VOLA0VX77SK2shyitBdFsXLy6oXPxQOqo",
            "object_type": "variable_workflow"
          },
          {
            "schema_id": "datatype.string",
            "properties": {
              "value": "",
              "scope": "local",
              "name": "Webex Text",
              "type": "datatype.string",
              "description": "Placeholder for the text to send via Webex. This will be populated automatically",
              "is_required": false,
              "is_invisible": false
            },
            "unique_name": "variable_workflow_01VOLA0VX7LLC6Dl4VeSM1wnnkk6XhEtlP2",
            "object_type": "variable_workflow"
          },
          {
            "schema_id": "datatype.string",
            "properties": {
              "value": "",
              "scope": "input",
              "name": "Blog Post URL",
              "type": "datatype.string",
              "description": "The URL of the blog post to investigate. This will be provided by the parent workflow",
              "is_required": true,
              "is_invisible": false
            },
            "unique_name": "variable_workflow_01VOLA0VX7SMR4YXBdZgLUGSpHwwCZop6bE",
            "object_type": "variable_workflow"
          },
          {
            "schema_id": "datatype.integer",
            "properties": {
              "value": 0,
              "scope": "local",
              "name": "Number of Non-Clean Observables",
              "type": "datatype.integer",
              "description": "How many non-clean observables were found during the investigation (as in: unknown, suspicious, or malicious)",
              "is_required": false,
              "is_invisible": false
            },
            "unique_name": "variable_workflow_01VOLA0VX8J3D7FQz7kPNU6tjNaOQtdLH5t",
            "object_type": "variable_workflow"
          },
          {
            "schema_id": "datatype.string",
            "properties": {
              "value": "[]",
              "scope": "local",
              "name": "Non-Clean Observables",
              "type": "datatype.string",
              "description": "A JSON-formatted list of observables that have a disposition of unknown, suspicious, or malicious. This will be populated automatically",
              "is_required": false,
              "is_invisible": false
            },
            "unique_name": "variable_workflow_01VOLA0VX6K2732labOJ5LOmDvdgxelI8tR",
            "object_type": "variable_workflow"
          },
          {
            "schema_id": "datatype.string",
            "properties": {
              "value": "",
              "scope": "local",
              "name": "Threat Response Environment URL",
              "type": "datatype.string",
              "description": "Placeholder for the URL of the Threat Response environment being used. You don't need to provide this, it will be fetched automatically",
              "is_required": false,
              "is_invisible": false
            },
            "unique_name": "variable_workflow_01VOLA0VX69HY0vQLLGkNg5YlqOXxEDfK2U",
            "object_type": "variable_workflow"
          },
          {
            "schema_id": "datatype.date",
            "properties": {
              "value": "0001-01-01T00:00:00+00:00",
              "scope": "local",
              "name": "Threat Response Token Time",
              "type": "datatype.date",
              "description": "The time at which the Threat Response access token was last fetched. This is used to determine when it's time to fetch a new token and should not be modified",
              "is_required": false,
              "is_invisible": false
            },
            "unique_name": "variable_workflow_01VOLA0VX6TJY2F0zCL733sxG6BZsbOrkya",
            "object_type": "variable_workflow"
          },
          {
            "schema_id": "datatype.secure_string",
            "properties": {
              "value": "",
              "scope": "local",
              "name": "Threat Response Access Token",
              "type": "datatype.secure_string",
              "description": "Placeholder for the Threat Response access token. This token will be fetched as needed throughout the workflow and this variable should not be modified",
              "is_required": false,
              "is_invisible": false
            },
            "unique_name": "variable_workflow_01VOLA0VX7ER84EewkpzfbLS0l4WfPbDqRE",
            "object_type": "variable_workflow"
          },
          {
            "schema_id": "datatype.string",
            "properties": {
              "value": "[]",
              "scope": "local",
              "name": "Sightings",
              "type": "datatype.string",
              "description": "Placeholder for a list of sightings from your Threat Response modules. This will be populated automatically",
              "is_required": false,
              "is_invisible": false
            },
            "unique_name": "variable_workflow_01VOLA0VX88945QCe9BWC8mR681P6bQuWVY",
            "object_type": "variable_workflow"
          }
        ],
        "properties": {
          "atomic": {
            "is_atomic": false
          },
          "delete_workflow_instance": false,
          "description": "This workflow takes a Talos blog post, conducts an investigation into it using Cisco Threat Response, and then puts the results in a SecureX casebook. If a Webex Teams room name and bot token are provided, a message with the investigation's results will be sent.\n\nTarget Group: Default TargetGroup\n\nTargets: CTR_For_Access_Token, CTR_API, Private_CTIA_Target, Webex Teams\n\nSteps:\n[] Fetch the blog post content and strip out any HTML\n[] Request a Threat Response access token and inspect the blog post content for observables\n[] Loop through each observable and get its Threat Response disposition\n[] For observables that weren't clean, conduct Threat Response enrichment to get sightings\n[] For modules with sightings, build the text to post to Webex\n[] Create the SecureX casebook and, if a teams room is provided, post a message to Webex\n\nMore information: https://ciscosecurity.github.io/sxo-05-security-workflows/workflows/0001",
          "display_name": "Talos - Blog Post to SecureX Casebook",
          "runtime_user": {
            "override_target_runtime_user": false,
            "specify_on_workflow_start": false,
            "target_default": true
          },
          "target": {
            "execute_on_target_group": true,
            "target_group": {
              "target_group_id": "target_group_01EJ0TQWPQWBD0qiWqClJKj9FOzwiZRfOFH",
              "run_on_all_targets": false,
              "selected_target_types": [
                "web-service.endpoint"
              ],
              "use_criteria": {
                "choose_target_using_algorithm": "choose_first_with_matching_criteria",
                "conditions": [
                  {
                    "operator": "eqi",
                    "left_operand": "$targetgroup.web-service endpoint.input.display_name$",
                    "right_operand": "CTR_API"
                  }
                ]
              }
            }
          }
        },
        "object_type": "definition_workflow",
        "actions": [
          {
            "unique_name": "definition_activity_01VOLA128S8MD3YBp0OK3mQjKpTrN65qdBg",
            "name": "Condition Block",
            "title": "Set the environment URL",
            "type": "logic.if_else",
            "base_type": "activity",
            "properties": {
              "continue_on_failure": false,
              "display_name": "Set the environment URL",
              "skip_execution": false
            },
            "object_type": "definition_activity",
            "blocks": [
              {
                "unique_name": "definition_activity_01VOLA13J2UCD4q301HHYs5vsy2Z2duSnx7",
                "name": "Condition Branch",
                "title": "PROD-NAM",
                "type": "logic.condition_block",
                "base_type": "activity",
                "properties": {
                  "condition": {
                    "left_operand": "$env.variable_01A6C871LSO9A26D0zcBjJoAKgRglrC10aG.env.variable_01A6C871LSO9A26D0zcBjJoAKgRglrC10aG$",
                    "operator": "eqi",
                    "right_operand": "prod-nam"
                  },
                  "continue_on_failure": false,
                  "display_name": "PROD-NAM",
                  "skip_execution": false
                },
                "object_type": "definition_activity",
                "actions": [
                  {
                    "unique_name": "definition_activity_01VOLA14XZJTA30yyNyShQvVAuDjpSkwHC0",
                    "name": "Set Variables",
                    "title": "Set local environment variables",
                    "type": "core.set_multiple_variables",
                    "base_type": "activity",
                    "properties": {
                      "continue_on_failure": false,
                      "display_name": "Set local environment variables",
                      "skip_execution": false,
                      "variables_to_update": [
                        {
                          "variable_to_update": "$workflow.definition_workflow_01VOLA0VQ6P2T2IZPvsWqEKAmYFbu5J1X9T.local.variable_workflow_01VOLA0VX69HY0vQLLGkNg5YlqOXxEDfK2U$",
                          "variable_value_new": "visibility.amp.cisco.com"
                        }
                      ]
                    },
                    "object_type": "definition_activity"
                  }
                ]
              },
              {
                "unique_name": "definition_activity_01VOLA1608TL05pTpWg6VujKnzd4vvBWemR",
                "name": "Condition Branch",
                "title": "PROD-EU",
                "type": "logic.condition_block",
                "base_type": "activity",
                "properties": {
                  "condition": {
                    "left_operand": "$env.variable_01A6C871LSO9A26D0zcBjJoAKgRglrC10aG.env.variable_01A6C871LSO9A26D0zcBjJoAKgRglrC10aG$",
                    "operator": "eqi",
                    "right_operand": "prod-eu"
                  },
                  "continue_on_failure": false,
                  "display_name": "PROD-EU",
                  "skip_execution": false
                },
                "object_type": "definition_activity",
                "actions": [
                  {
                    "unique_name": "definition_activity_01VOLA1768GNS6hjNMYnYiP14p2fJa3y9GD",
                    "name": "Set Variables",
                    "title": "Set local environment variables",
                    "type": "core.set_multiple_variables",
                    "base_type": "activity",
                    "properties": {
                      "continue_on_failure": false,
                      "display_name": "Set local environment variables",
                      "skip_execution": false,
                      "variables_to_update": [
                        {
                          "variable_to_update": "$workflow.definition_workflow_01VOLA0VQ6P2T2IZPvsWqEKAmYFbu5J1X9T.local.variable_workflow_01VOLA0VX69HY0vQLLGkNg5YlqOXxEDfK2U$",
                          "variable_value_new": "visibility.eu.amp.cisco.com"
                        }
                      ]
                    },
                    "object_type": "definition_activity"
                  }
                ]
              },
              {
                "unique_name": "definition_activity_01VOLA184I8WP1UIBWpjDWhKbVXb5P3foWy",
                "name": "Condition Branch",
                "title": "PROD-APJC",
                "type": "logic.condition_block",
                "base_type": "activity",
                "properties": {
                  "condition": {
                    "left_operand": "$env.variable_01A6C871LSO9A26D0zcBjJoAKgRglrC10aG.env.variable_01A6C871LSO9A26D0zcBjJoAKgRglrC10aG$",
                    "operator": "eqi",
                    "right_operand": "prod-apjc"
                  },
                  "continue_on_failure": false,
                  "display_name": "PROD-APJC",
                  "skip_execution": false
                },
                "object_type": "definition_activity",
                "actions": [
                  {
                    "unique_name": "definition_activity_01VOLA195T6CB44bgpNmc6S9PQvGmkSUrci",
                    "name": "Set Variables",
                    "title": "Set local environment variables",
                    "type": "core.set_multiple_variables",
                    "base_type": "activity",
                    "properties": {
                      "continue_on_failure": false,
                      "display_name": "Set local environment variables",
                      "skip_execution": false,
                      "variables_to_update": [
                        {
                          "variable_to_update": "$workflow.definition_workflow_01VOLA0VQ6P2T2IZPvsWqEKAmYFbu5J1X9T.local.variable_workflow_01VOLA0VX69HY0vQLLGkNg5YlqOXxEDfK2U$",
                          "variable_value_new": "visibility.apjc.amp.cisco.com"
                        }
                      ]
                    },
                    "object_type": "definition_activity"
                  }
                ]
              }
            ]
          },
          {
            "unique_name": "definition_activity_01VOLA1AA972O7lcmjb2Ga3oGzpIVWEHDs7",
            "name": "Group",
            "title": "Fetch and process blog post",
            "type": "logic.group",
            "base_type": "activity",
            "properties": {
              "continue_on_failure": false,
              "display_name": "Fetch and process blog post",
              "skip_execution": false
            },
            "object_type": "definition_activity",
            "actions": [
              {
                "unique_name": "definition_activity_01VOLA1BV69K470mYLsPvSsCiHFexPsvuiz",
                "name": "Execute Python Script",
                "title": "Fetch and clean blog post",
                "type": "python3.script",
                "base_type": "activity",
                "properties": {
                  "action_timeout": 180,
                  "continue_on_failure": true,
                  "display_name": "Fetch and clean blog post",
                  "script": "import sys,re,requests\n\n# Get the blog post URL from the script input\nblogUrl = sys.argv[1]\n\n# Request the content of the blog post\nblogRequest = requests.get(blogUrl, headers={ 'User-Agent': 'SecureX/definition_workflow_01FX7FQDZRDUX1TWgKJwTPBMaOWrgUOld2q' })\n\n# Make sure the request was successful\nif not blogRequest.status_code == 200:\n    sys.exit(\"Unable to fetch blog content. HTTP code \" + blogRequest.status_code)\n\n# Extract the HTML of the blog post\nblogHtml = blogRequest.text\n\n# Default the blog post to being unavailable in case we can't find it\npostTitle = \"Post Title Unavailable\"\n\n# Attempt to extract the blog post title from the HTML\ntitleMatches = re.search(r'\u003ctitle\u003e([^\u003c]+)\u003c\\/title\u003e', blogHtml, re.MULTILINE)\nif titleMatches:\n    # We found a \u003ctitle\u003e tag, so use that as the title\n    postTitle = titleMatches.group(1)\n    postTitle = postTitle[(postTitle.find(\":\") + 2):]\n    postTitle = postTitle.replace(\"\\\"\", \"'\")\n\n# Strip \u003cscript /\u003e tags\nblogHtml = re.sub(r'\u003cscript\\b[^\u003c]*(?:(?!\u003c\\/script\u003e)\u003c[^\u003c]*)*\u003c\\/script\u003e', '', str(blogHtml), flags=re.DOTALL)\n\n# Strip \u003cstyle /\u003e tags\nblogHtml = re.sub(r'\u003cstyle\\b[^\u003c]*(?:(?!\u003c\\/style\u003e)\u003c[^\u003c]*)*\u003c\\/style\u003e', '', blogHtml, flags=re.DOTALL)\n\n# Strip other HTML\nblogHtml = re.sub(r'\u003c[^\u003c]+?\u003e', '', blogHtml, flags=re.DOTALL)\n\n# Replace new lines with a space\nblogHtml = blogHtml.replace(\"\\n\", \" \")",
                  "script_arguments": [
                    "$workflow.definition_workflow_01VOLA0VQ6P2T2IZPvsWqEKAmYFbu5J1X9T.input.variable_workflow_01VOLA0VX7SMR4YXBdZgLUGSpHwwCZop6bE$"
                  ],
                  "script_queries": [
                    {
                      "script_query": "blogHtml",
                      "script_query_name": "blogHtml",
                      "script_query_type": "string"
                    },
                    {
                      "script_query": "postTitle",
                      "script_query_name": "postTitle",
                      "script_query_type": "string"
                    }
                  ],
                  "skip_execution": false
                },
                "object_type": "definition_activity"
              },
              {
                "unique_name": "definition_activity_01VOLA1CT6TMK23AYbobpW5Evz5vuaZzpuV",
                "name": "Condition Block",
                "title": "Were we able to fetch and clean the blog post?",
                "type": "logic.if_else",
                "base_type": "activity",
                "properties": {
                  "continue_on_failure": false,
                  "display_name": "Were we able to fetch and clean the blog post?",
                  "skip_execution": false
                },
                "object_type": "definition_activity",
                "blocks": [
                  {
                    "unique_name": "definition_activity_01VOLA1DQJNMV1jX82AklxDMuCUiwBtu9fU",
                    "name": "Condition Branch",
                    "title": "No",
                    "type": "logic.condition_block",
                    "base_type": "activity",
                    "properties": {
                      "condition": {
                        "left_operand": "$activity.definition_activity_01VOLA1BV69K470mYLsPvSsCiHFexPsvuiz.output.succeeded$",
                        "operator": "eq",
                        "right_operand": false
                      },
                      "continue_on_failure": false,
                      "display_name": "No",
                      "skip_execution": false
                    },
                    "object_type": "definition_activity",
                    "actions": [
                      {
                        "unique_name": "definition_activity_01VOLA1EXT8T640aP6WNnTRLhpw7A7wjJoJ",
                        "name": "Completed",
                        "title": "Failed",
                        "type": "logic.completed",
                        "base_type": "activity",
                        "properties": {
                          "completion_type": "failed-completed",
                          "continue_on_failure": false,
                          "display_name": "Failed",
                          "result_message": "Failed to fetch and/or clean the blog post content\n\nPython result: $activity.definition_activity_01VOLA1BV69K470mYLsPvSsCiHFexPsvuiz.output.response_body$",
                          "skip_execution": false
                        },
                        "object_type": "definition_activity"
                      }
                    ]
                  }
                ]
              }
            ]
          },
          {
            "unique_name": "definition_activity_01VOLA1RSIMQK4gk27vZ47oK2aOnaoA4g6O",
            "name": "Group",
            "title": "Inspect the blog  content",
            "type": "logic.group",
            "base_type": "activity",
            "properties": {
              "continue_on_failure": false,
              "display_name": "Inspect the blog  content",
              "skip_execution": false
            },
            "object_type": "definition_activity",
            "actions": [
              {
                "unique_name": "definition_activity_01VOLA1U9D0140s09eytJ4XV0m4VXjuvRFF",
                "name": "Threat Response - Generate Access Token",
                "title": "Threat Response - Generate Access Token",
                "type": "workflow.atomic_workflow",
                "base_type": "subworkflow",
                "properties": {
                  "continue_on_failure": false,
                  "display_name": "Threat Response - Generate Access Token",
                  "runtime_user": {
                    "target_default": true
                  },
                  "skip_execution": false,
                  "target": {
                    "override_workflow_target_group_criteria": true,
                    "target_group": {
                      "run_on_all_targets": false,
                      "use_criteria": {
                        "choose_target_using_algorithm": "choose_first_with_matching_criteria",
                        "conditions": [
                          {
                            "left_operand": "$targetgroup.web-service endpoint.input.display_name$",
                            "operator": "eqi",
                            "right_operand": "CTR_For_Access_Token"
                          }
                        ]
                      }
                    }
                  },
                  "workflow_id": "definition_workflow_01PP75S3LTBW4420OZU3rdHWKHFnE6aC7yH",
                  "workflow_name": "Threat Response - Generate Access Token"
                },
                "object_type": "definition_activity"
              },
              {
                "unique_name": "definition_activity_01VOLA1WVFCLK6lEsNFqAslw2sn0AwekZa3",
                "name": "Set Variables",
                "title": "Set local token variables",
                "type": "core.set_multiple_variables",
                "base_type": "activity",
                "properties": {
                  "continue_on_failure": false,
                  "display_name": "Set local token variables",
                  "skip_execution": false,
                  "variables_to_update": [
                    {
                      "variable_to_update": "$workflow.definition_workflow_01VOLA0VQ6P2T2IZPvsWqEKAmYFbu5J1X9T.local.variable_workflow_01VOLA0VX7ER84EewkpzfbLS0l4WfPbDqRE$",
                      "variable_value_new": "$activity.definition_activity_01VOLA1U9D0140s09eytJ4XV0m4VXjuvRFF.output.variable_workflow_01PP75S3G7CJY6WAQr2IJC7qga2SIoE09gQ$"
                    },
                    {
                      "variable_to_update": "$workflow.definition_workflow_01VOLA0VQ6P2T2IZPvsWqEKAmYFbu5J1X9T.local.variable_workflow_01VOLA0VX6TJY2F0zCL733sxG6BZsbOrkya$",
                      "variable_value_new": "$activity.definition_activity_01VOLA1U9D0140s09eytJ4XV0m4VXjuvRFF.output.start_time$"
                    }
                  ]
                },
                "object_type": "definition_activity"
              },
              {
                "unique_name": "definition_activity_01VOLA1ZIHCZ41s4b5Rtsx4qF7x5sVkrUBw",
                "name": "Threat Response - Inspect for Observables",
                "title": "Threat Response - Inspect for Observables",
                "type": "workflow.atomic_workflow",
                "base_type": "subworkflow",
                "properties": {
                  "continue_on_failure": false,
                  "display_name": "Threat Response - Inspect for Observables",
                  "input": {
                    "variable_workflow_01PP7586F8ITB1sT6OpDzEF79wnWVOJk1N5": "$workflow.definition_workflow_01VOLA0VQ6P2T2IZPvsWqEKAmYFbu5J1X9T.local.variable_workflow_01VOLA0VX7ER84EewkpzfbLS0l4WfPbDqRE$",
                    "variable_workflow_01PP7586F8MQB2tFYbNgQC7xGbC7ZoXrOxR": "$activity.definition_activity_01VOLA1BV69K470mYLsPvSsCiHFexPsvuiz.output.script_queries.blogHtml$"
                  },
                  "runtime_user": {
                    "target_default": true
                  },
                  "skip_execution": false,
                  "target": {
                    "use_workflow_target_group": true
                  },
                  "workflow_id": "definition_workflow_01PP7586MYQ913P0nWshTHMU7mQNNFG58Bv",
                  "workflow_name": "Threat Response - Inspect for Observables"
                },
                "object_type": "definition_activity"
              },
              {
                "unique_name": "definition_activity_01VOLA21B6YCH509BSdT4ZIzOtLZIAAQQc2",
                "name": "JSONPath Query",
                "title": "Test for results",
                "type": "corejava.jsonpathquery",
                "base_type": "activity",
                "properties": {
                  "action_timeout": 180,
                  "continue_on_failure": true,
                  "display_name": "Test for results",
                  "input_json": "$activity.definition_activity_01VOLA1ZIHCZ41s4b5Rtsx4qF7x5sVkrUBw.output.variable_workflow_01PP7586F8O067JBDnBPz8ZD5XctKNSenEX$",
                  "jsonpath_queries": [
                    {
                      "jsonpath_query": "$.[0].value",
                      "jsonpath_query_name": "inspectTest",
                      "jsonpath_query_type": "string"
                    }
                  ],
                  "skip_execution": false
                },
                "object_type": "definition_activity"
              },
              {
                "unique_name": "definition_activity_01VOLA22GCLPP1DENoRAN5JGeUtPviTA7Q4",
                "name": "Condition Block",
                "title": "Were there any observables?",
                "type": "logic.if_else",
                "base_type": "activity",
                "properties": {
                  "continue_on_failure": false,
                  "display_name": "Were there any observables?",
                  "skip_execution": false
                },
                "object_type": "definition_activity",
                "blocks": [
                  {
                    "unique_name": "definition_activity_01VOLA23ICH8S79DZbQAmgdwl18vihuzEBL",
                    "name": "Condition Branch",
                    "title": "No",
                    "type": "logic.condition_block",
                    "base_type": "activity",
                    "properties": {
                      "condition": {
                        "left_operand": "$activity.definition_activity_01VOLA21B6YCH509BSdT4ZIzOtLZIAAQQc2.output.succeeded$",
                        "operator": "eq",
                        "right_operand": false
                      },
                      "continue_on_failure": false,
                      "display_name": "No",
                      "skip_execution": false
                    },
                    "object_type": "definition_activity",
                    "actions": [
                      {
                        "unique_name": "definition_activity_01VOLA24LVQA33JUfh1T4QOYlP8vUO0goi8",
                        "name": "Completed",
                        "title": "Nothing to investigate",
                        "type": "logic.completed",
                        "base_type": "activity",
                        "properties": {
                          "completion_type": "succeeded",
                          "continue_on_failure": false,
                          "display_name": "Nothing to investigate",
                          "result_message": "The blog post \"$activity.definition_activity_01VOLA1BV69K470mYLsPvSsCiHFexPsvuiz.output.script_queries.postTitle$\" was inspected but no observables to investigate were found",
                          "skip_execution": false
                        },
                        "object_type": "definition_activity"
                      }
                    ]
                  }
                ]
              },
              {
                "unique_name": "definition_activity_01VOLA268UECW3rB1XZLse6BUGGePK4zn4g",
                "name": "Read Table from JSON",
                "title": "Convert list of observables to table",
                "type": "corejava.read_table_from_json",
                "base_type": "activity",
                "properties": {
                  "action_timeout": 180,
                  "continue_on_failure": false,
                  "display_name": "Convert list of observables to table",
                  "input_json": "$activity.definition_activity_01VOLA1ZIHCZ41s4b5Rtsx4qF7x5sVkrUBw.output.variable_workflow_01PP7586F8O067JBDnBPz8ZD5XctKNSenEX$",
                  "jsonpath_query": "$.*",
                  "persist_output": true,
                  "populate_columns": false,
                  "skip_execution": false,
                  "table_columns": [
                    {
                      "column_name": "type",
                      "column_type": "string"
                    },
                    {
                      "column_name": "value",
                      "column_type": "string"
                    },
                    {
                      "column_name": "disposition",
                      "column_type": "string"
                    }
                  ]
                },
                "object_type": "definition_activity"
              }
            ]
          },
          {
            "unique_name": "definition_activity_01VOLA27OIJGX5dsdZHOWGDpGJxZsbzpYHs",
            "name": "Group",
            "title": "Deliberate the observables",
            "type": "logic.group",
            "base_type": "activity",
            "properties": {
              "continue_on_failure": false,
              "display_name": "Deliberate the observables",
              "skip_execution": false
            },
            "object_type": "definition_activity",
            "actions": [
              {
                "unique_name": "definition_activity_01VOLA295OJGT1uptdC9OgOXFXVDAxS2tlO",
                "name": "For Each",
                "title": "For each observable",
                "type": "logic.for_each",
                "base_type": "activity",
                "properties": {
                  "continue_on_failure": false,
                  "display_name": "For each observable",
                  "skip_execution": false,
                  "source_array": "$activity.definition_activity_01VOLA268UECW3rB1XZLse6BUGGePK4zn4g.output.read_table_from_json$"
                },
                "object_type": "definition_activity",
                "actions": [
                  {
                    "unique_name": "definition_activity_01VOLA2BAQLJS2zZiNvlR6qYke0J3l1vE4F",
                    "name": "Threat Response - Deliberate Observable",
                    "title": "Threat Response - Deliberate Observable",
                    "type": "workflow.atomic_workflow",
                    "base_type": "subworkflow",
                    "properties": {
                      "continue_on_failure": false,
                      "display_name": "Threat Response - Deliberate Observable",
                      "input": {
                        "variable_workflow_01PP77MLJ2S465LuOvU8mlP8mbbcgy9uTXN": "$activity.definition_activity_01VOLA295OJGT1uptdC9OgOXFXVDAxS2tlO.input.source_array[@].type$",
                        "variable_workflow_01PP77MLJ2XIE1H3D67PjcsCuGBsKCCBxLI": "$workflow.definition_workflow_01VOLA0VQ6P2T2IZPvsWqEKAmYFbu5J1X9T.local.variable_workflow_01VOLA0VX7ER84EewkpzfbLS0l4WfPbDqRE$",
                        "variable_workflow_01PP77MLJ2ZVU1C4VxEfKYh2tlFk9iTx69p": "$activity.definition_activity_01VOLA295OJGT1uptdC9OgOXFXVDAxS2tlO.input.source_array[@].value$"
                      },
                      "runtime_user": {
                        "target_default": true
                      },
                      "skip_execution": false,
                      "target": {
                        "use_workflow_target_group": true
                      },
                      "workflow_id": "definition_workflow_01PP77MLQ4QAG765OwlT0ZDqBzv80HvYuPC",
                      "workflow_name": "Threat Response - Deliberate Observable"
                    },
                    "object_type": "definition_activity"
                  },
                  {
                    "unique_name": "definition_activity_01VOLA2CY6AQC7kOpcmjkTZItnNcnn3qu0w",
                    "name": "Group",
                    "title": "Validate Threat Response token",
                    "type": "logic.group",
                    "base_type": "activity",
                    "properties": {
                      "continue_on_failure": false,
                      "display_name": "Validate Threat Response token",
                      "skip_execution": false
                    },
                    "object_type": "definition_activity",
                    "actions": [
                      {
                        "unique_name": "definition_activity_01VOLA2EKUSXW6wzInukDM57VLoluJ8hiAZ",
                        "name": "Calculate Date Time Difference",
                        "title": "Check token age",
                        "type": "core.calculate_date_time_difference",
                        "base_type": "activity",
                        "properties": {
                          "continue_on_failure": false,
                          "display_name": "Check token age",
                          "original_date": "$activity.definition_activity_01VOLA2BAQLJS2zZiNvlR6qYke0J3l1vE4F.output.end_time$",
                          "skip_execution": false,
                          "subtract_date": "$workflow.definition_workflow_01VOLA0VQ6P2T2IZPvsWqEKAmYFbu5J1X9T.local.variable_workflow_01VOLA0VX6TJY2F0zCL733sxG6BZsbOrkya$"
                        },
                        "object_type": "definition_activity"
                      },
                      {
                        "unique_name": "definition_activity_01VOLA2FOLOV04t8c4tx5wqo3Xabwtqjaba",
                        "name": "Condition Block",
                        "title": "Is it over 8 minutes?",
                        "type": "logic.if_else",
                        "base_type": "activity",
                        "properties": {
                          "continue_on_failure": false,
                          "display_name": "Is it over 8 minutes?",
                          "skip_execution": false
                        },
                        "object_type": "definition_activity",
                        "blocks": [
                          {
                            "unique_name": "definition_activity_01VOLA2GOOUAO20Pah43pypx6JqBRbJ5W9d",
                            "name": "Condition Branch",
                            "title": "Yes",
                            "type": "logic.condition_block",
                            "base_type": "activity",
                            "properties": {
                              "condition": {
                                "left_operand": "$activity.definition_activity_01VOLA2EKUSXW6wzInukDM57VLoluJ8hiAZ.output.total_minutes$",
                                "operator": "gte",
                                "right_operand": 8
                              },
                              "continue_on_failure": false,
                              "display_name": "Yes",
                              "skip_execution": false
                            },
                            "object_type": "definition_activity",
                            "actions": [
                              {
                                "unique_name": "definition_activity_01VOLA2IEG94V1pBSK82D6pd2EeHTxpLE8c",
                                "name": "Threat Response - Generate Access Token",
                                "title": "Threat Response - Generate Access Token",
                                "type": "workflow.atomic_workflow",
                                "base_type": "subworkflow",
                                "properties": {
                                  "continue_on_failure": false,
                                  "display_name": "Threat Response - Generate Access Token",
                                  "runtime_user": {
                                    "target_default": true
                                  },
                                  "skip_execution": false,
                                  "target": {
                                    "override_workflow_target_group_criteria": true,
                                    "target_group": {
                                      "run_on_all_targets": false,
                                      "use_criteria": {
                                        "choose_target_using_algorithm": "choose_first_with_matching_criteria",
                                        "conditions": [
                                          {
                                            "left_operand": "$targetgroup.web-service endpoint.input.display_name$",
                                            "operator": "eqi",
                                            "right_operand": "CTR_For_Access_Token"
                                          }
                                        ]
                                      }
                                    }
                                  },
                                  "workflow_id": "definition_workflow_01PP75S3LTBW4420OZU3rdHWKHFnE6aC7yH",
                                  "workflow_name": "Threat Response - Generate Access Token"
                                },
                                "object_type": "definition_activity"
                              },
                              {
                                "unique_name": "definition_activity_01VOLA2JV0JUJ7IyIdXMUjwREfPQzCKuGsc",
                                "name": "Set Variables",
                                "title": "Set local token variables",
                                "type": "core.set_multiple_variables",
                                "base_type": "activity",
                                "properties": {
                                  "continue_on_failure": false,
                                  "display_name": "Set local token variables",
                                  "skip_execution": false,
                                  "variables_to_update": [
                                    {
                                      "variable_to_update": "$workflow.definition_workflow_01VOLA0VQ6P2T2IZPvsWqEKAmYFbu5J1X9T.local.variable_workflow_01VOLA0VX7ER84EewkpzfbLS0l4WfPbDqRE$",
                                      "variable_value_new": "$activity.definition_activity_01VOLA2IEG94V1pBSK82D6pd2EeHTxpLE8c.output.variable_workflow_01PP75S3G7CJY6WAQr2IJC7qga2SIoE09gQ$"
                                    },
                                    {
                                      "variable_to_update": "$workflow.definition_workflow_01VOLA0VQ6P2T2IZPvsWqEKAmYFbu5J1X9T.local.variable_workflow_01VOLA0VX6TJY2F0zCL733sxG6BZsbOrkya$",
                                      "variable_value_new": "$activity.definition_activity_01VOLA2IEG94V1pBSK82D6pd2EeHTxpLE8c.output.start_time$"
                                    }
                                  ]
                                },
                                "object_type": "definition_activity"
                              }
                            ]
                          }
                        ]
                      }
                    ]
                  },
                  {
                    "unique_name": "definition_activity_01VOLA2LKB70V2eNM0oCLVj9nfdo5lFCKUY",
                    "name": "Update Row in Table",
                    "title": "Update observable table with disposition",
                    "type": "core.updaterowintable",
                    "base_type": "activity",
                    "properties": {
                      "action_timeout": 180,
                      "columns": [
                        {
                          "column_name": "disposition",
                          "column_type": "string"
                        }
                      ],
                      "continue_on_failure": false,
                      "display_name": "Update observable table with disposition",
                      "input_table": "$activity.definition_activity_01VOLA268UECW3rB1XZLse6BUGGePK4zn4g.output.read_table_from_json$",
                      "row": [
                        {
                          "key": "disposition",
                          "type": "string",
                          "value": "$activity.definition_activity_01VOLA2BAQLJS2zZiNvlR6qYke0J3l1vE4F.output.variable_workflow_01PP77MLJ2W9N3jUUa3J6gIRy7Dydhs937R$"
                        }
                      ],
                      "rows": {
                        "rows_matching_criteria": true,
                        "where_clause": "type == '$activity.definition_activity_01VOLA295OJGT1uptdC9OgOXFXVDAxS2tlO.input.source_array[@].type$' AND value == '$activity.definition_activity_01VOLA295OJGT1uptdC9OgOXFXVDAxS2tlO.input.source_array[@].value$'"
                      },
                      "skip_execution": false
                    },
                    "object_type": "definition_activity"
                  },
                  {
                    "unique_name": "definition_activity_01VOLA2MTZY4R0mrw0gDkXRa3rGfxzbFYrq",
                    "name": "Condition Block",
                    "title": "Was this observable clean?",
                    "type": "logic.if_else",
                    "base_type": "activity",
                    "properties": {
                      "continue_on_failure": false,
                      "display_name": "Was this observable clean?",
                      "skip_execution": false
                    },
                    "object_type": "definition_activity",
                    "blocks": [
                      {
                        "unique_name": "definition_activity_01VOLA2NUV0B002UGYxchDsCzDkltzdMh9f",
                        "name": "Condition Branch",
                        "title": "No",
                        "type": "logic.condition_block",
                        "base_type": "activity",
                        "properties": {
                          "condition": {
                            "left_operand": "$activity.definition_activity_01VOLA2BAQLJS2zZiNvlR6qYke0J3l1vE4F.output.variable_workflow_01PP77MLJ2W9N3jUUa3J6gIRy7Dydhs937R$",
                            "operator": "ne",
                            "right_operand": "Clean"
                          },
                          "continue_on_failure": false,
                          "display_name": "No",
                          "skip_execution": false
                        },
                        "object_type": "definition_activity",
                        "actions": [
                          {
                            "unique_name": "definition_activity_01VOLA2OZKCN36YTdWiks0YJGmi9tbkXBHD",
                            "name": "Execute Python Script",
                            "title": "Append this observable to our observable JSON",
                            "type": "python3.script",
                            "base_type": "activity",
                            "properties": {
                              "action_timeout": 180,
                              "continue_on_failure": false,
                              "display_name": "Append this observable to our observable JSON",
                              "script": "import sys,json\n\n# Parse the existing list of observables\nexisting = json.loads(sys.argv[1])\n\n# Get the new observable information\nnewType = sys.argv[2]\nnewValue = sys.argv[3]\n\n# Append the new observable to the list\nexisting.append( { \"type\": newType, \"value\": newValue } )\n\n# Build the new JSON\nnewJson = json.dumps(existing)",
                              "script_arguments": [
                                "$workflow.definition_workflow_01VOLA0VQ6P2T2IZPvsWqEKAmYFbu5J1X9T.local.variable_workflow_01VOLA0VX6K2732labOJ5LOmDvdgxelI8tR$",
                                "$activity.definition_activity_01VOLA295OJGT1uptdC9OgOXFXVDAxS2tlO.input.source_array[@].type$",
                                "$activity.definition_activity_01VOLA295OJGT1uptdC9OgOXFXVDAxS2tlO.input.source_array[@].value$"
                              ],
                              "script_queries": [
                                {
                                  "script_query": "newJson",
                                  "script_query_name": "newJson",
                                  "script_query_type": "string"
                                }
                              ],
                              "skip_execution": false
                            },
                            "object_type": "definition_activity"
                          },
                          {
                            "unique_name": "definition_activity_01VOLA2Q7Q5294Iz3dDVWIa99AESrB1OgHY",
                            "name": "Set Variables",
                            "title": "Update observable local variables",
                            "type": "core.set_multiple_variables",
                            "base_type": "activity",
                            "properties": {
                              "continue_on_failure": false,
                              "display_name": "Update observable local variables",
                              "skip_execution": false,
                              "variables_to_update": [
                                {
                                  "variable_to_update": "$workflow.definition_workflow_01VOLA0VQ6P2T2IZPvsWqEKAmYFbu5J1X9T.local.variable_workflow_01VOLA0VX6K2732labOJ5LOmDvdgxelI8tR$",
                                  "variable_value_new": "$activity.definition_activity_01VOLA2OZKCN36YTdWiks0YJGmi9tbkXBHD.output.script_queries.newJson$"
                                },
                                {
                                  "variable_to_update": "$workflow.definition_workflow_01VOLA0VQ6P2T2IZPvsWqEKAmYFbu5J1X9T.local.variable_workflow_01VOLA0VX8J3D7FQz7kPNU6tjNaOQtdLH5t$",
                                  "variable_value_new": "$workflow.definition_workflow_01VOLA0VQ6P2T2IZPvsWqEKAmYFbu5J1X9T.local.variable_workflow_01VOLA0VX8J3D7FQz7kPNU6tjNaOQtdLH5t$+1"
                                }
                              ]
                            },
                            "object_type": "definition_activity"
                          }
                        ]
                      }
                    ]
                  }
                ]
              },
              {
                "unique_name": "definition_activity_01VOLA2RCQN4I56UBcabvukWvfpjOQJipxO",
                "name": "Condition Block",
                "title": "Were all of the observables clean?",
                "type": "logic.if_else",
                "base_type": "activity",
                "properties": {
                  "continue_on_failure": false,
                  "display_name": "Were all of the observables clean?",
                  "skip_execution": false
                },
                "object_type": "definition_activity",
                "blocks": [
                  {
                    "unique_name": "definition_activity_01VOLA2SANDRY3Y8zhJRnZABo0wXuWPtU4d",
                    "name": "Condition Branch",
                    "title": "Yes",
                    "type": "logic.condition_block",
                    "base_type": "activity",
                    "properties": {
                      "condition": {
                        "left_operand": "$workflow.definition_workflow_01VOLA0VQ6P2T2IZPvsWqEKAmYFbu5J1X9T.local.variable_workflow_01VOLA0VX8J3D7FQz7kPNU6tjNaOQtdLH5t$",
                        "operator": "eq",
                        "right_operand": 0
                      },
                      "continue_on_failure": false,
                      "display_name": "Yes",
                      "skip_execution": false
                    },
                    "object_type": "definition_activity",
                    "actions": [
                      {
                        "unique_name": "definition_activity_01VOLA2TF23J153f8F0jZURAbuARx7M6Dzj",
                        "name": "Completed",
                        "title": "No suspicious observables",
                        "type": "logic.completed",
                        "base_type": "activity",
                        "properties": {
                          "completion_type": "succeeded",
                          "continue_on_failure": false,
                          "display_name": "No suspicious observables",
                          "result_message": "The blog post \"$activity.definition_activity_01VOLA1BV69K470mYLsPvSsCiHFexPsvuiz.output.script_queries.postTitle$\" was investigated but all of the observables were clean",
                          "skip_execution": false
                        },
                        "object_type": "definition_activity"
                      }
                    ]
                  }
                ]
              }
            ]
          },
          {
            "unique_name": "definition_activity_01VOLA2UD7TXY6kcFh3u73ULlBz7EzoKC7h",
            "name": "Group",
            "title": "Enrich the observables",
            "type": "logic.group",
            "base_type": "activity",
            "properties": {
              "continue_on_failure": false,
              "display_name": "Enrich the observables",
              "skip_execution": false
            },
            "object_type": "definition_activity",
            "actions": [
              {
                "unique_name": "definition_activity_01VOLA2VOMK7U0gX0mBTIny8TgalxHexrTx",
                "name": "For Each",
                "title": "For each observable",
                "type": "logic.for_each",
                "base_type": "activity",
                "properties": {
                  "continue_on_failure": false,
                  "display_name": "For each observable",
                  "skip_execution": false,
                  "source_array": "$activity.definition_activity_01VOLA268UECW3rB1XZLse6BUGGePK4zn4g.output.read_table_from_json$"
                },
                "object_type": "definition_activity",
                "actions": [
                  {
                    "unique_name": "definition_activity_01VOLA2XAG2P45yn12f0FEwVwzCyUQEPJ7W",
                    "name": "Condition Block",
                    "title": "Is this observable clean?",
                    "type": "logic.if_else",
                    "base_type": "activity",
                    "properties": {
                      "continue_on_failure": false,
                      "display_name": "Is this observable clean?",
                      "skip_execution": false
                    },
                    "object_type": "definition_activity",
                    "blocks": [
                      {
                        "unique_name": "definition_activity_01VOLA2YBNMI22yeY24ZZ5MtR0m4jwWarax",
                        "name": "Condition Branch",
                        "title": "Yes",
                        "type": "logic.condition_block",
                        "base_type": "activity",
                        "properties": {
                          "condition": {
                            "left_operand": "$activity.definition_activity_01VOLA2VOMK7U0gX0mBTIny8TgalxHexrTx.input.source_array[@].disposition$",
                            "operator": "eqi",
                            "right_operand": "Clean"
                          },
                          "continue_on_failure": false,
                          "display_name": "Yes",
                          "skip_execution": false
                        },
                        "object_type": "definition_activity",
                        "actions": [
                          {
                            "unique_name": "definition_activity_01VOLA2ZQF20C65Tg80dIndSYTpkP8gWBrY",
                            "name": "Continue",
                            "title": "Skip this observable",
                            "type": "logic.continue",
                            "base_type": "activity",
                            "properties": {
                              "continue_on_failure": false,
                              "display_name": "Skip this observable",
                              "skip_execution": false
                            },
                            "object_type": "definition_activity"
                          }
                        ]
                      }
                    ]
                  },
                  {
                    "unique_name": "definition_activity_01VOLA30TTHA94ynYUpcs2jucyUvXBaoCjn",
                    "name": "Group",
                    "title": "Validate Threat Response token",
                    "type": "logic.group",
                    "base_type": "activity",
                    "properties": {
                      "continue_on_failure": false,
                      "display_name": "Validate Threat Response token",
                      "skip_execution": false
                    },
                    "object_type": "definition_activity",
                    "actions": [
                      {
                        "unique_name": "definition_activity_01VOLA32A7FWZ2JwPOY1WDlPWhuOwt7zp6g",
                        "name": "Calculate Date Time Difference",
                        "title": "Check token age",
                        "type": "core.calculate_date_time_difference",
                        "base_type": "activity",
                        "properties": {
                          "continue_on_failure": false,
                          "display_name": "Check token age",
                          "original_date": "$activity.definition_activity_01VOLA2XAG2P45yn12f0FEwVwzCyUQEPJ7W.output.end_time$",
                          "skip_execution": false,
                          "subtract_date": "$workflow.definition_workflow_01VOLA0VQ6P2T2IZPvsWqEKAmYFbu5J1X9T.local.variable_workflow_01VOLA0VX6TJY2F0zCL733sxG6BZsbOrkya$"
                        },
                        "object_type": "definition_activity"
                      },
                      {
                        "unique_name": "definition_activity_01VOLA33GUX7Q7N4CG02qzxoGWVWLh8Lck3",
                        "name": "Condition Block",
                        "title": "Is it over 8 minutes?",
                        "type": "logic.if_else",
                        "base_type": "activity",
                        "properties": {
                          "continue_on_failure": false,
                          "display_name": "Is it over 8 minutes?",
                          "skip_execution": false
                        },
                        "object_type": "definition_activity",
                        "blocks": [
                          {
                            "unique_name": "definition_activity_01VOLA34HFNT53dcdjCUwOi5l7utr9fe9rE",
                            "name": "Condition Branch",
                            "title": "Yes",
                            "type": "logic.condition_block",
                            "base_type": "activity",
                            "properties": {
                              "condition": {
                                "left_operand": "$activity.definition_activity_01VOLA32A7FWZ2JwPOY1WDlPWhuOwt7zp6g.output.total_minutes$",
                                "operator": "gte",
                                "right_operand": 8
                              },
                              "continue_on_failure": false,
                              "display_name": "Yes",
                              "skip_execution": false
                            },
                            "object_type": "definition_activity",
                            "actions": [
                              {
                                "unique_name": "definition_activity_01VOLA3695VIA7HTFZDhAcfPgwYqb08TKto",
                                "name": "Threat Response - Generate Access Token",
                                "title": "Threat Response - Generate Access Token",
                                "type": "workflow.atomic_workflow",
                                "base_type": "subworkflow",
                                "properties": {
                                  "continue_on_failure": false,
                                  "display_name": "Threat Response - Generate Access Token",
                                  "runtime_user": {
                                    "target_default": true
                                  },
                                  "skip_execution": false,
                                  "target": {
                                    "override_workflow_target_group_criteria": true,
                                    "target_group": {
                                      "run_on_all_targets": false,
                                      "use_criteria": {
                                        "choose_target_using_algorithm": "choose_first_with_matching_criteria",
                                        "conditions": [
                                          {
                                            "left_operand": "$targetgroup.web-service endpoint.input.display_name$",
                                            "operator": "eqi",
                                            "right_operand": "CTR_For_Access_Token"
                                          }
                                        ]
                                      }
                                    }
                                  },
                                  "workflow_id": "definition_workflow_01PP75S3LTBW4420OZU3rdHWKHFnE6aC7yH",
                                  "workflow_name": "Threat Response - Generate Access Token"
                                },
                                "object_type": "definition_activity"
                              },
                              {
                                "unique_name": "definition_activity_01VOLA37PVODI2Na25PGEl8BfhdxA8WyB0o",
                                "name": "Set Variables",
                                "title": "Set local token variables",
                                "type": "core.set_multiple_variables",
                                "base_type": "activity",
                                "properties": {
                                  "continue_on_failure": false,
                                  "display_name": "Set local token variables",
                                  "skip_execution": false,
                                  "variables_to_update": [
                                    {
                                      "variable_to_update": "$workflow.definition_workflow_01VOLA0VQ6P2T2IZPvsWqEKAmYFbu5J1X9T.local.variable_workflow_01VOLA0VX7ER84EewkpzfbLS0l4WfPbDqRE$",
                                      "variable_value_new": "$activity.definition_activity_01VOLA3695VIA7HTFZDhAcfPgwYqb08TKto.output.variable_workflow_01PP75S3G7CJY6WAQr2IJC7qga2SIoE09gQ$"
                                    },
                                    {
                                      "variable_to_update": "$workflow.definition_workflow_01VOLA0VQ6P2T2IZPvsWqEKAmYFbu5J1X9T.local.variable_workflow_01VOLA0VX6TJY2F0zCL733sxG6BZsbOrkya$",
                                      "variable_value_new": "$activity.definition_activity_01VOLA3695VIA7HTFZDhAcfPgwYqb08TKto.output.start_time$"
                                    }
                                  ]
                                },
                                "object_type": "definition_activity"
                              }
                            ]
                          }
                        ]
                      }
                    ]
                  },
                  {
                    "unique_name": "definition_activity_01VOLA39PM4QL3z6N0adaaONOJ8ymf4ApzF",
                    "name": "Threat Response - Enrich Observable",
                    "title": "Threat Response - Enrich Observable",
                    "type": "workflow.atomic_workflow",
                    "base_type": "subworkflow",
                    "properties": {
                      "continue_on_failure": false,
                      "display_name": "Threat Response - Enrich Observable",
                      "input": {
                        "variable_workflow_01PP78TYDTQ2L5AWh7XpLPkXldkBYssq6SC": "$activity.definition_activity_01VOLA2VOMK7U0gX0mBTIny8TgalxHexrTx.input.source_array[@].value$",
                        "variable_workflow_01PP78TYDTTUQ6Qtv47uK5sgOFSbJ4b4Cno": "$activity.definition_activity_01VOLA2VOMK7U0gX0mBTIny8TgalxHexrTx.input.source_array[@].type$",
                        "variable_workflow_01PP78TYDTV5R5JK6DtYaS5E95bWbZBstS5": "$workflow.definition_workflow_01VOLA0VQ6P2T2IZPvsWqEKAmYFbu5J1X9T.local.variable_workflow_01VOLA0VX7ER84EewkpzfbLS0l4WfPbDqRE$"
                      },
                      "runtime_user": {
                        "target_default": true
                      },
                      "skip_execution": false,
                      "target": {
                        "use_workflow_target_group": true
                      },
                      "workflow_id": "definition_workflow_01PP78TYLE76D6188QkWvzWydNU6L8PtlvS",
                      "workflow_name": "Threat Response - Enrich Observable"
                    },
                    "object_type": "definition_activity"
                  },
                  {
                    "unique_name": "definition_activity_01VOLA3B5U6464I3dbYQhDCXpTMFdj4T0kL",
                    "name": "Read Table from JSON",
                    "title": "Convert list of enrichments to table",
                    "type": "corejava.read_table_from_json",
                    "base_type": "activity",
                    "properties": {
                      "action_timeout": 180,
                      "continue_on_failure": true,
                      "display_name": "Convert list of enrichments to table",
                      "input_json": "$activity.definition_activity_01VOLA39PM4QL3z6N0adaaONOJ8ymf4ApzF.output.variable_workflow_01PP78TYDTWG01QGHDq5uwDKdvEqS9CdcYg$",
                      "jsonpath_query": "$.data[*]",
                      "persist_output": false,
                      "populate_columns": false,
                      "skip_execution": false,
                      "table_columns": [
                        {
                          "column_name": "module",
                          "column_type": "string"
                        },
                        {
                          "column_name": "module_type",
                          "column_type": "string"
                        },
                        {
                          "column_name": "data",
                          "column_type": "string"
                        }
                      ]
                    },
                    "object_type": "definition_activity"
                  },
                  {
                    "unique_name": "definition_activity_01VOLA3CGF1KC1E1sQYn0bBGmaZAI1jJ7UP",
                    "name": "Condition Block",
                    "title": "Were there any enrichment results?",
                    "type": "logic.if_else",
                    "base_type": "activity",
                    "properties": {
                      "continue_on_failure": false,
                      "display_name": "Were there any enrichment results?",
                      "skip_execution": false
                    },
                    "object_type": "definition_activity",
                    "blocks": [
                      {
                        "unique_name": "definition_activity_01VOLA3DL7ZTN2fd9IG25zKe0HA1Tzk8EgX",
                        "name": "Condition Branch",
                        "title": "No",
                        "type": "logic.condition_block",
                        "base_type": "activity",
                        "properties": {
                          "condition": {
                            "left_operand": "$activity.definition_activity_01VOLA3B5U6464I3dbYQhDCXpTMFdj4T0kL.output.succeeded$",
                            "operator": "eq",
                            "right_operand": false
                          },
                          "continue_on_failure": false,
                          "display_name": "No",
                          "skip_execution": false
                        },
                        "object_type": "definition_activity",
                        "actions": [
                          {
                            "unique_name": "definition_activity_01VOLA3EVB90Q5daN9CUh8D8kQMveGGl1IX",
                            "name": "Continue",
                            "title": "Skip this observable",
                            "type": "logic.continue",
                            "base_type": "activity",
                            "properties": {
                              "continue_on_failure": false,
                              "display_name": "Skip this observable",
                              "skip_execution": false
                            },
                            "object_type": "definition_activity"
                          }
                        ]
                      }
                    ]
                  },
                  {
                    "unique_name": "definition_activity_01VOLA3G0353I28BvF9iP6zsvRbHS97vOf2",
                    "name": "For Each",
                    "title": "For each enriched module",
                    "type": "logic.for_each",
                    "base_type": "activity",
                    "properties": {
                      "continue_on_failure": false,
                      "display_name": "For each enriched module",
                      "skip_execution": false,
                      "source_array": "$activity.definition_activity_01VOLA3B5U6464I3dbYQhDCXpTMFdj4T0kL.output.read_table_from_json$"
                    },
                    "object_type": "definition_activity",
                    "actions": [
                      {
                        "unique_name": "definition_activity_01VOLA3HN5B6F6us2fbMZcT1K7ETp1GYrrk",
                        "name": "JSONPath Query",
                        "title": "Extract sightings",
                        "type": "corejava.jsonpathquery",
                        "base_type": "activity",
                        "properties": {
                          "action_timeout": 180,
                          "continue_on_failure": true,
                          "display_name": "Extract sightings",
                          "input_json": "$activity.definition_activity_01VOLA3G0353I28BvF9iP6zsvRbHS97vOf2.input.source_array[@].data$",
                          "jsonpath_queries": [
                            {
                              "jsonpath_query": "$.sightings.count",
                              "jsonpath_query_name": "sightingCount",
                              "jsonpath_query_type": "string"
                            },
                            {
                              "jsonpath_query": "$.sightings.docs",
                              "jsonpath_query_name": "sightingData",
                              "jsonpath_query_type": "string"
                            }
                          ],
                          "skip_execution": false
                        },
                        "object_type": "definition_activity"
                      },
                      {
                        "unique_name": "definition_activity_01VOLA3IPTCHU0XXgnzStV57jAqAS6RWHgS",
                        "name": "Condition Block",
                        "title": "Do we care about this module?",
                        "type": "logic.if_else",
                        "base_type": "activity",
                        "properties": {
                          "continue_on_failure": false,
                          "display_name": "Do we care about this module?",
                          "skip_execution": false
                        },
                        "object_type": "definition_activity",
                        "blocks": [
                          {
                            "unique_name": "definition_activity_01VOLA3JR9J234F1aRGB2cp0lCqgvG6Upkv",
                            "name": "Condition Branch",
                            "title": "No sightings, skip it",
                            "type": "logic.condition_block",
                            "base_type": "activity",
                            "properties": {
                              "condition": {
                                "left_operand": "$activity.definition_activity_01VOLA3HN5B6F6us2fbMZcT1K7ETp1GYrrk.output.succeeded$",
                                "operator": "eq",
                                "right_operand": false
                              },
                              "continue_on_failure": false,
                              "display_name": "No sightings, skip it",
                              "skip_execution": false
                            },
                            "object_type": "definition_activity",
                            "actions": [
                              {
                                "unique_name": "definition_activity_01VOLA3KWRX183JpEqCGowbMKUWCpHlYNTj",
                                "name": "Continue",
                                "title": "Skip this module",
                                "type": "logic.continue",
                                "base_type": "activity",
                                "properties": {
                                  "continue_on_failure": false,
                                  "display_name": "Skip this module",
                                  "skip_execution": false
                                },
                                "object_type": "definition_activity"
                              }
                            ]
                          }
                        ]
                      },
                      {
                        "unique_name": "definition_activity_01VOLA3LV6T0O2soNOQIzGtE3gqXdGDvEUV",
                        "name": "Execute Python Script",
                        "title": "Extract sightings and targets",
                        "type": "python3.script",
                        "base_type": "activity",
                        "properties": {
                          "action_timeout": 180,
                          "continue_on_failure": false,
                          "display_name": "Extract sightings and targets",
                          "script": "import sys,json\n\n# Get the name of the module being investigated\nmoduleName = sys.argv[1]\n\n# Parse the existing list of sightings and targets\nexistingSightings = json.loads(sys.argv[3])\nexistingTargets = json.loads(sys.argv[4])\n\n# Parse the new sightings\nnewSightings = json.loads(sys.argv[2])\n\n# Loop through each sighting\nfor sighting in newSightings:\n\tsighting[\"module_name\"] = moduleName\n\t\n\t# Append this sighting to the master list\n\texistingSightings.append(sighting)\n\t\n\t# Check if this sighting has any targets\n\tif \"targets\" in sighting.keys() and len(sighting[\"targets\"]) \u003e 0:\n\t\t# Loop through each target\n\t\tfor target in sighting[\"targets\"]:\n\t\t\t# Check if this target is an endpoint\n\t\t\tif target[\"type\"] == \"endpoint\":\n\t\t\t\t# Loop through each observable\n\t\t\t\tfor observable in target[\"observables\"]:\n\t\t\t\t\tif observable[\"type\"] == \"amp_computer_guid\" and not observable in existingTargets:\n\t\t\t\t\t\texistingTargets.append(observable)\n\n# Build the new JSON\nnewSightings = json.dumps(existingSightings)\nnewTargets = json.dumps(existingTargets)",
                          "script_arguments": [
                            "$activity.definition_activity_01VOLA3G0353I28BvF9iP6zsvRbHS97vOf2.input.source_array[@].module$",
                            "$activity.definition_activity_01VOLA3HN5B6F6us2fbMZcT1K7ETp1GYrrk.output.jsonpath_queries.sightingData$",
                            "$workflow.definition_workflow_01VOLA0VQ6P2T2IZPvsWqEKAmYFbu5J1X9T.local.variable_workflow_01VOLA0VX88945QCe9BWC8mR681P6bQuWVY$",
                            "$workflow.definition_workflow_01VOLA0VQ6P2T2IZPvsWqEKAmYFbu5J1X9T.local.variable_workflow_01VOLA0VX77SK2shyitBdFsXLy6oXPxQOqo$"
                          ],
                          "script_queries": [
                            {
                              "script_query": "newSightings",
                              "script_query_name": "newSightings",
                              "script_query_type": "string"
                            },
                            {
                              "script_query": "newTargets",
                              "script_query_name": "newTargets",
                              "script_query_type": "string"
                            }
                          ],
                          "skip_execution": false
                        },
                        "object_type": "definition_activity"
                      },
                      {
                        "unique_name": "definition_activity_01VOLA3N5SXPQ2mVr4fecbTDIc0a7YQ2XyK",
                        "name": "Set Variables",
                        "title": "Update local variables",
                        "type": "core.set_multiple_variables",
                        "base_type": "activity",
                        "properties": {
                          "continue_on_failure": false,
                          "display_name": "Update local variables",
                          "skip_execution": false,
                          "variables_to_update": [
                            {
                              "variable_to_update": "$workflow.definition_workflow_01VOLA0VQ6P2T2IZPvsWqEKAmYFbu5J1X9T.local.variable_workflow_01VOLA0VX88945QCe9BWC8mR681P6bQuWVY$",
                              "variable_value_new": "$activity.definition_activity_01VOLA3LV6T0O2soNOQIzGtE3gqXdGDvEUV.output.script_queries.newSightings$"
                            },
                            {
                              "variable_to_update": "$workflow.definition_workflow_01VOLA0VQ6P2T2IZPvsWqEKAmYFbu5J1X9T.local.variable_workflow_01VOLA0VX77SK2shyitBdFsXLy6oXPxQOqo$",
                              "variable_value_new": "$activity.definition_activity_01VOLA3LV6T0O2soNOQIzGtE3gqXdGDvEUV.output.script_queries.newTargets$"
                            }
                          ]
                        },
                        "object_type": "definition_activity"
                      }
                    ]
                  }
                ]
              }
            ]
          },
          {
            "unique_name": "definition_activity_01VOLA3O952YQ0iD2mXB2lv1gESbhYx0gKl",
            "name": "Group",
            "title": "Validate Threat Response token",
            "type": "logic.group",
            "base_type": "activity",
            "properties": {
              "continue_on_failure": false,
              "display_name": "Validate Threat Response token",
              "skip_execution": false
            },
            "object_type": "definition_activity",
            "actions": [
              {
                "unique_name": "definition_activity_01VOLA3PLD6BZ5gJDmGHhYeoFB3KLWQGZls",
                "name": "Calculate Date Time Difference",
                "title": "Check token age",
                "type": "core.calculate_date_time_difference",
                "base_type": "activity",
                "properties": {
                  "continue_on_failure": false,
                  "display_name": "Check token age",
                  "original_date": "$activity.definition_activity_01VOLA2UD7TXY6kcFh3u73ULlBz7EzoKC7h.output.end_time$",
                  "skip_execution": false,
                  "subtract_date": "$workflow.definition_workflow_01VOLA0VQ6P2T2IZPvsWqEKAmYFbu5J1X9T.local.variable_workflow_01VOLA0VX6TJY2F0zCL733sxG6BZsbOrkya$"
                },
                "object_type": "definition_activity"
              },
              {
                "unique_name": "definition_activity_01VOLA3QMYKLB2bAuLQSoCliIpyv51PQAyt",
                "name": "Condition Block",
                "title": "Is it over 8 minutes?",
                "type": "logic.if_else",
                "base_type": "activity",
                "properties": {
                  "continue_on_failure": false,
                  "display_name": "Is it over 8 minutes?",
                  "skip_execution": false
                },
                "object_type": "definition_activity",
                "blocks": [
                  {
                    "unique_name": "definition_activity_01VOLA3RN9YCZ0lOfCcKSsxJk0Y2PbYMEwZ",
                    "name": "Condition Branch",
                    "title": "Yes",
                    "type": "logic.condition_block",
                    "base_type": "activity",
                    "properties": {
                      "condition": {
                        "left_operand": "$activity.definition_activity_01VOLA3PLD6BZ5gJDmGHhYeoFB3KLWQGZls.output.total_minutes$",
                        "operator": "gte",
                        "right_operand": 8
                      },
                      "continue_on_failure": false,
                      "display_name": "Yes",
                      "skip_execution": false
                    },
                    "object_type": "definition_activity",
                    "actions": [
                      {
                        "unique_name": "definition_activity_01VOLA3TI0JQ445fWWuqhhpcWV0R4PVDuVA",
                        "name": "Threat Response - Generate Access Token",
                        "title": "Threat Response - Generate Access Token",
                        "type": "workflow.atomic_workflow",
                        "base_type": "subworkflow",
                        "properties": {
                          "continue_on_failure": false,
                          "display_name": "Threat Response - Generate Access Token",
                          "runtime_user": {
                            "target_default": true
                          },
                          "skip_execution": false,
                          "target": {
                            "override_workflow_target_group_criteria": true,
                            "target_group": {
                              "run_on_all_targets": false,
                              "use_criteria": {
                                "choose_target_using_algorithm": "choose_first_with_matching_criteria",
                                "conditions": [
                                  {
                                    "left_operand": "$targetgroup.web-service endpoint.input.display_name$",
                                    "operator": "eqi",
                                    "right_operand": "CTR_For_Access_Token"
                                  }
                                ]
                              }
                            }
                          },
                          "workflow_id": "definition_workflow_01PP75S3LTBW4420OZU3rdHWKHFnE6aC7yH",
                          "workflow_name": "Threat Response - Generate Access Token"
                        },
                        "object_type": "definition_activity"
                      },
                      {
                        "unique_name": "definition_activity_01VOLA3UTOBGS1INZGCnR1byJnsvAinLre5",
                        "name": "Set Variables",
                        "title": "Set local token variables",
                        "type": "core.set_multiple_variables",
                        "base_type": "activity",
                        "properties": {
                          "continue_on_failure": false,
                          "display_name": "Set local token variables",
                          "skip_execution": false,
                          "variables_to_update": [
                            {
                              "variable_to_update": "$workflow.definition_workflow_01VOLA0VQ6P2T2IZPvsWqEKAmYFbu5J1X9T.local.variable_workflow_01VOLA0VX7ER84EewkpzfbLS0l4WfPbDqRE$",
                              "variable_value_new": "$activity.definition_activity_01VOLA3TI0JQ445fWWuqhhpcWV0R4PVDuVA.output.variable_workflow_01PP75S3G7CJY6WAQr2IJC7qga2SIoE09gQ$"
                            },
                            {
                              "variable_to_update": "$workflow.definition_workflow_01VOLA0VQ6P2T2IZPvsWqEKAmYFbu5J1X9T.local.variable_workflow_01VOLA0VX6TJY2F0zCL733sxG6BZsbOrkya$",
                              "variable_value_new": "$activity.definition_activity_01VOLA3TI0JQ445fWWuqhhpcWV0R4PVDuVA.output.start_time$"
                            }
                          ]
                        },
                        "object_type": "definition_activity"
                      }
                    ]
                  }
                ]
              }
            ]
          },
          {
            "unique_name": "definition_activity_01VOLA3W2Z6YM2CUlFBh4lfZv6LOjfUrOoK",
            "name": "Group",
            "title": "Create casebook and post to Webex",
            "type": "logic.group",
            "base_type": "activity",
            "properties": {
              "continue_on_failure": false,
              "display_name": "Create casebook and post to Webex",
              "skip_execution": false
            },
            "object_type": "definition_activity",
            "actions": [
              {
                "unique_name": "definition_activity_01VOLA3XGGQ9626guGG8mmEH8rVttw6jEqa",
                "name": "Execute Python Script",
                "title": "Convert sighting data to usable text for messaging",
                "type": "python3.script",
                "base_type": "activity",
                "properties": {
                  "action_timeout": 180,
                  "continue_on_failure": false,
                  "display_name": "Convert sighting data to usable text for messaging",
                  "script": "import sys,json\n\n# Get and parse the sighting data\nsightings = json.loads(sys.argv[1])\n\n# Placeholders for output\nsightingCounts = {}\nmoduleNames = []\ntargets = []\n\n# Loop through each sighting\nfor sighting in sightings:\n\t# If there aren't any targets, initialize that array index to an empty list\n\tif not \"targets\" in sighting:\n\t\tsighting[\"targets\"] = []\n\t\t\n\t# Loop through each target\n\ttargetCount = 0\n\tfor target in sighting[\"targets\"]:\n\t\t# Remove the observed time (so two of the same target aren't considered different)\n\t\tdel target[\"observed_time\"]\n\t\t\n\t\t# Add this target to our master list if it's not already in the list (and count it)\n\t\tif not target in targets:\n\t\t\ttargetCount += 1\n\t\t\ttargets.append(target)\n\t\n\t# Is this module already in our count array?\n\tif sighting[\"module_name\"] in sightingCounts.keys():\n\t\t# Yes, so increment the counts\n\t\tsightingCounts[sighting[\"module_name\"]][\"count\"] += 1\n\t\tsightingCounts[sighting[\"module_name\"]][\"targets\"] += targetCount\n\telse:\n\t\t# No, so add it and its counts\n\t\tsightingCounts[sighting[\"module_name\"]] = {\n\t\t\t\"count\": 1,\n\t\t\t\"targets\": targetCount\n\t\t}\n\t\tmoduleNames.append(sighting[\"module_name\"])\n\n# Placeholders for output\nmarkdownSummary = \"\"\nmarkdownTruncated = False\n\n# Were there any sightings to begin with?\nif len(sightings) == 0:\n\tmarkdownSummary = \"* No sightings or targets were found\"\nelse:\n\t# Loop through the sighting counts\n\tfor module in moduleNames:\n\t\t# Make sure the markdown summary (for Threat Response and Webex) isn't already too long\n\t\tif len(markdownSummary.encode(\"utf-8\")) \u003e 4000 and not markdownTruncated:\n\t\t\t# It's getting too long, so add a message indicating that the text was truncated\n\t\t\tmarkdownSummary = markdownSummary + \"\\n\\n Additional information was available but truncated due to message length\"\n\t\t\tmarkdownTruncated = True\n\t\telif not markdownTruncated:\n\t\t\t# The message isn't too long, so append this module\n\t\t\tmarkdownSummary = markdownSummary + (\"\\n\" if len(markdownSummary) \u003e 0 else \"\") + \"* Module **\" + module + \"** returned **\" + str(sightingCounts[module][\"count\"]) + \" sightings** with a total of **\" + str(sightingCounts[module][\"targets\"]) + \" targets**\"",
                  "script_arguments": [
                    "$workflow.definition_workflow_01VOLA0VQ6P2T2IZPvsWqEKAmYFbu5J1X9T.local.variable_workflow_01VOLA0VX88945QCe9BWC8mR681P6bQuWVY$"
                  ],
                  "script_queries": [
                    {
                      "script_query": "markdownSummary",
                      "script_query_name": "markdownSummary",
                      "script_query_type": "string"
                    }
                  ],
                  "skip_execution": false
                },
                "object_type": "definition_activity"
              },
              {
                "unique_name": "definition_activity_01VOLA3ZCYWMW5JZQig0NX60Uyt5fN2TmEB",
                "name": "Threat Response - Create Casebook",
                "title": "Threat Response - Create Casebook",
                "type": "workflow.atomic_workflow",
                "base_type": "subworkflow",
                "properties": {
                  "continue_on_failure": false,
                  "display_name": "Threat Response - Create Casebook",
                  "input": {
                    "variable_workflow_01PP75X6NM0AY6YDlJckkMg6hCbMEMGO72O": "$workflow.definition_workflow_01VOLA0VQ6P2T2IZPvsWqEKAmYFbu5J1X9T.local.variable_workflow_01VOLA0VX6K2732labOJ5LOmDvdgxelI8tR$",
                    "variable_workflow_01PP75X6NM1M46Jjob8LUKg8R3yRRVOvu9q": "$workflow.definition_workflow_01VOLA0VQ6P2T2IZPvsWqEKAmYFbu5J1X9T.local.variable_workflow_01VOLA0VX7ER84EewkpzfbLS0l4WfPbDqRE$",
                    "variable_workflow_01PP75X6NM2V27Or3EssfIABNZiE45Ddziu": "amber",
                    "variable_workflow_01PP75X6NM4123PBwUedJ5QqeBr8G1sefjQ": "Talos: $activity.definition_activity_01VOLA1BV69K470mYLsPvSsCiHFexPsvuiz.output.script_queries.postTitle$",
                    "variable_workflow_01PP75X6NM54W5qTbpCb1h6bTTrp7eFQjaq": "Casebook generated from a Talos blog post",
                    "variable_workflow_01PP75X6NM7FE4BmQ3AKIykyWFDSV9umy02": "SecureX orchestration generated this casebook from an RSS feed\n\n| Post Title | $activity.definition_activity_01VOLA1BV69K470mYLsPvSsCiHFexPsvuiz.output.script_queries.postTitle$ |\n|---------------|-------------|\n| Post URL | $workflow.definition_workflow_01VOLA0VQ6P2T2IZPvsWqEKAmYFbu5J1X9T.input.variable_workflow_01VOLA0VX7SMR4YXBdZgLUGSpHwwCZop6bE$|\n| Time | $activity.definition_activity_01VOLA2UD7TXY6kcFh3u73ULlBz7EzoKC7h.output.end_time$ |\n\n**Sighting Summary**:\n$activity.definition_activity_01VOLA3XGGQ9626guGG8mmEH8rVttw6jEqa.output.script_queries.markdownSummary$"
                  },
                  "runtime_user": {
                    "target_default": true
                  },
                  "skip_execution": false,
                  "target": {
                    "override_workflow_target_group_criteria": true,
                    "target_group": {
                      "run_on_all_targets": false,
                      "use_criteria": {
                        "choose_target_using_algorithm": "choose_first_with_matching_criteria",
                        "conditions": [
                          {
                            "left_operand": "$targetgroup.web-service endpoint.input.display_name$",
                            "operator": "eqi",
                            "right_operand": "Private_CTIA_Target"
                          }
                        ]
                      }
                    }
                  },
                  "workflow_id": "definition_workflow_01PP75X6VPQNK4hKE1XQXIMeIcHrE1khIML",
                  "workflow_name": "Threat Response - Create Casebook"
                },
                "object_type": "definition_activity"
              },
              {
                "unique_name": "definition_activity_01VOLA48LLF2L5euN8WEe3XWwtA60z6ruBr",
                "name": "Webex Teams - Post Message to Room",
                "title": "Webex Teams - Post Message to Room",
                "type": "workflow.atomic_workflow",
                "base_type": "subworkflow",
                "properties": {
                  "continue_on_failure": false,
                  "display_name": "Webex Teams - Post Message to Room",
                  "input": {
                    "variable_workflow_01PP78DJH1TI76BYfsu9g0Tqj2S6cUxjtu5": "Y2lzY29zcGFyazovL3VzL1JPT00vODNkMzVlMzAtYWFkYi0xMWVjLTg4NWItNDNjMWE0ZmMyMTVl",
                    "variable_workflow_01PP78DJH1XNQ7gNQ5iZdperRHqrppzARXC": "$env.variable_01VV6QKZGWUH70LtaJK0PunYbGZmbGYzM2B.env.variable_01VV6QKZGWUH70LtaJK0PunYbGZmbGYzM2B$",
                    "variable_workflow_01PP78DJH1YWL3allalGQbg1VkgKwh9GvCi": "A SecureX casebook has been created for the blog post [$activity.definition_activity_01VOLA1BV69K470mYLsPvSsCiHFexPsvuiz.output.script_queries.postTitle$]($workflow.definition_workflow_01VOLA0VQ6P2T2IZPvsWqEKAmYFbu5J1X9T.input.variable_workflow_01VOLA0VX7SMR4YXBdZgLUGSpHwwCZop6bE$) from Talos. [Click here](https://$workflow.definition_workflow_01VOLA0VQ6P2T2IZPvsWqEKAmYFbu5J1X9T.local.variable_workflow_01VOLA0VX69HY0vQLLGkNg5YlqOXxEDfK2U$/investigate?spid=$activity.definition_activity_01VOLA3ZCYWMW5JZQig0NX60Uyt5fN2TmEB.output.variable_workflow_01PP75X6NLWYO1BiZbBFEXJyqmmfiQcqId3$) to investigate\n\n**Sighting Summary:**\n$activity.definition_activity_01VOLA3XGGQ9626guGG8mmEH8rVttw6jEqa.output.script_queries.markdownSummary$",
                    "variable_workflow_01PP78DJH22BB3Ej3I8tJ4OCQur0unYGjj9": "",
                    "variable_workflow_01SVERQNMKN8N6vqX2djMtAfshphGydGsH8": ""
                  },
                  "runtime_user": {
                    "target_default": true
                  },
                  "skip_execution": false,
                  "target": {
                    "override_workflow_target_group_criteria": true,
                    "target_group": {
                      "run_on_all_targets": false,
                      "use_criteria": {
                        "choose_target_using_algorithm": "choose_first_with_matching_criteria",
                        "conditions": [
                          {
                            "left_operand": "$targetgroup.web-service endpoint.input.display_name$",
                            "operator": "eqi",
                            "right_operand": "Webex Teams"
                          }
                        ]
                      }
                    }
                  },
                  "workflow_id": "definition_workflow_01PP78DJMXS415nTjonujf03ROkr6t2PNyw",
                  "workflow_name": "Webex - Post Message to Room"
                },
                "object_type": "definition_activity"
              }
            ]
          }
        ],
        "categories": [
          "category_1BMfMXSnJMyt5Ihqi7rWJr5N8cf"
        ]
      },
      "dependent_workflows": [
        "definition_workflow_01PP75S3LTBW4420OZU3rdHWKHFnE6aC7yH",
        "definition_workflow_01PP7586MYQ913P0nWshTHMU7mQNNFG58Bv",
        "definition_workflow_01PP77MLQ4QAG765OwlT0ZDqBzv80HvYuPC",
        "definition_workflow_01PP78TYLE76D6188QkWvzWydNU6L8PtlvS",
        "definition_workflow_01PP75X6VPQNK4hKE1XQXIMeIcHrE1khIML",
        "definition_workflow_01PP78DJMXS415nTjonujf03ROkr6t2PNyw"
      ]
    }
  ],
  "atomic_workflows": [
    "definition_workflow_01PP78TYLE76D6188QkWvzWydNU6L8PtlvS",
    "definition_workflow_01PP77MLQ4QAG765OwlT0ZDqBzv80HvYuPC",
    "definition_workflow_01PP75X6VPQNK4hKE1XQXIMeIcHrE1khIML",
    "definition_workflow_01PP75S3LTBW4420OZU3rdHWKHFnE6aC7yH",
    "definition_workflow_01PP7586MYQ913P0nWshTHMU7mQNNFG58Bv",
    "definition_workflow_01PP78DJMXS415nTjonujf03ROkr6t2PNyw"
  ],
  "dependent_workflows": [
    "definition_workflow_01VOLA0VQ6P2T2IZPvsWqEKAmYFbu5J1X9T"
  ]
}